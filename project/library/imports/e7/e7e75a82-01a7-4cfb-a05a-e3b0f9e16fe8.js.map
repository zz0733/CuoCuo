{"version":3,"sources":["../../../../../../assets/hall/script/login/assets/hall/script/login/login.js"],"names":["cc","Class","extends","Component","properties","gameName","type","gameConst","default","hall","onLoad","sys","isNative","console","log","jsb","fileUtils","getWritablePath","JSPhoneVoice","require","clearOldVoice","getBaiDuLocation","_isApple","fun","gameCfg","releaseType","apple","_isFisher","fisher","node","getChildByName","active","editBox","wxLoginBtn","ykLoginBtn","isIDLogin","loginType","ID","getComponent","Label","string","director","preloadScene","enableUpdate","db","getData","event","add","onCompleteUpdateEvent","bind","initLogin","version","onDestroy","remove","isWxAppInstalled","install","setPositionX","token","localStorage","getItem","enableAutoLogin","net","connect","loginUrl","pSend","Token","Platform","os","loginHandle","OS_ANDROID","OS_IOS","WxAppIsInstalled","on","onLoginBtnClick","onGuestBtnClick","data","k","playEffect","weChatLogin","weChat","guestLogin","guest","idLogin","WxLogin","msg","state","wxLogin","Thirdparty","OpenId","openid","AccessToken","_isConnected","UserId","id","EditBox","length","parseInt","RetCode","func","once","dispatch","okCb","contentStr","closeCb","removeItem","utils","restart","setState","userInfo","location","undefined","setData","setItem","loadScene"],"mappings":"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","file":"login.js","sourceRoot":"../../../../../../assets/hall/script/login","sourcesContent":["﻿cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameName: {\r\n            type: gameConst.gameName,\r\n            default: gameConst.gameName.hall,\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        if (cc.sys.isNative) {\r\n            console.log('WritablePath = ' + jsb.fileUtils.getWritablePath());\r\n            let JSPhoneVoice = require('JSPhoneVoice');\r\n            JSPhoneVoice.clearOldVoice();\r\n            require('JSPhoneBaiDu').getBaiDuLocation();\r\n        }\r\n\r\n        // let isRelease = fun.gameCfg.releaseType === gameConst.releaseType.release ? true : false;\r\n        this._isApple = fun.gameCfg.releaseType === gameConst.releaseType.apple ? true : false;\r\n        this._isFisher = fun.gameCfg.releaseType === gameConst.releaseType.fisher ? true : false;\r\n        if (this._isFisher) {\r\n            this.node.getChildByName('Haishang').active = true;\r\n        }\r\n\r\n        this.editBox = this.node.getChildByName('editBox');\r\n        this.editBox.active = false;\r\n        this.wxLoginBtn = this.node.getChildByName('btnWxLogin');\r\n        this.ykLoginBtn = this.node.getChildByName('btnYkLogin');\r\n        \r\n        let isIDLogin = fun.gameCfg.loginType === gameConst.loginType.ID;\r\n        this.ykLoginBtn.getChildByName('Label').getComponent(cc.Label).string = isIDLogin ? '账号登陆' : '游客登陆';\r\n        cc.director.preloadScene(\"hall\", function () {});\r\n\r\n        if (cc.sys.isNative && fun.gameCfg.enableUpdate && !fun.db.getData('UpdatedGame')[this.gameName]) {\r\n            this.wxLoginBtn.active = false;\r\n            this.ykLoginBtn.active = false;\r\n            fun.event.add('hallUpdatedGame', 'UpdatedGame', this.onCompleteUpdateEvent.bind(this));\r\n        } else {\r\n            this.initLogin();\r\n        }\r\n        this.node.getChildByName('version').getComponent(cc.Label).string = gameConst.version;\r\n    },\r\n\r\n    onDestroy () {\r\n        fun.event.remove('hallUpdatedGame');\r\n    },\r\n\r\n    isWxAppInstalled (install) {\r\n        if(!install && this._isApple){\r\n            this.wxLoginBtn.active = false;\r\n            this.ykLoginBtn.setPositionX(0);\r\n            this.ykLoginBtn.active = true;\r\n        } else {\r\n            this.wxLoginBtn.active = true;\r\n            this.wxLoginBtn.setPositionX(0);\r\n            this.ykLoginBtn.active = false;\r\n        }\r\n    },\r\n\r\n    initLogin() {\r\n        let token = cc.sys.localStorage.getItem('Token');\r\n        if (token && fun.gameCfg.enableAutoLogin) {\r\n            fun.net.connect(fun.gameCfg.loginUrl, function () {\r\n                fun.net.pSend('TokenLogin', {Token: token, Platform: cc.sys.os}, this.loginHandle.bind(this));\r\n            }.bind(this))\r\n        } else {\r\n            if (cc.sys.os === cc.sys.OS_ANDROID) {\r\n                this.wxLoginBtn.active = true;\r\n                this.wxLoginBtn.setPositionX(0);\r\n                this.ykLoginBtn.active = false;\r\n            } else if (cc.sys.os === cc.sys.OS_IOS) {\r\n                this.isWxAppInstalled(require('JSPhoneWeChat').WxAppIsInstalled());\r\n            } else {\r\n                this.wxLoginBtn.active = true;\r\n                this.ykLoginBtn.active = true;\r\n            }\r\n            if (fun.gameCfg.loginType === gameConst.loginType.ID) {\r\n                this.editBox.active = true;\r\n            }\r\n            this.wxLoginBtn.on('click', this.onLoginBtnClick, this);\r\n            this.ykLoginBtn.on('click', this.onGuestBtnClick, this);\r\n        }\r\n    },\r\n\r\n    onCompleteUpdateEvent (data) {\r\n        for (const k in data) {\r\n            if (data[k] === this.gameName) {\r\n                this.initLogin();\r\n                break;\r\n            }\r\n        }\r\n    },\r\n\r\n    onLoginBtnClick (event) {\r\n        require('Audio').playEffect('hall', 'button_nomal.mp3');\r\n        fun.net.connect(fun.gameCfg.loginUrl, function () {\r\n            this.weChatLogin();\r\n        }.bind(this));\r\n    },\r\n\r\n    onGuestBtnClick(){\r\n        fun.net.connect(fun.gameCfg.loginUrl, function () {\r\n            switch (fun.gameCfg.loginType) {\r\n                case gameConst.loginType.weChat:\r\n                    this.guestLogin();\r\n                case gameConst.loginType.guest:\r\n                    this.guestLogin();\r\n                    break;\r\n                case gameConst.loginType.ID:\r\n                    this.idLogin();\r\n                    break;\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n    weChatLogin () {\r\n        fun.log('login', 'weChatLogin');\r\n        require('JSPhoneWeChat').WxLogin(function(msg){\r\n            if (msg.state) {\r\n                let wxLogin = {Thirdparty: 1, OpenId: msg.openid, AccessToken: msg.token, Platform: cc.sys.os};\r\n                if (fun.net._isConnected()) {\r\n                    fun.net.pSend('ThirdLogin', wxLogin, this.loginHandle.bind(this));\r\n                } else {\r\n                    fun.net.connect(fun.gameCfg.loginUrl, function() {\r\n                        fun.net.pSend('ThirdLogin', wxLogin, this.loginHandle.bind(this));\r\n                    }.bind(this));\r\n                }\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n    guestLogin () {\r\n        fun.log('login', 'guestLogin');\r\n        fun.net.pSend('GustLogin', {UserId: 0}, this.loginHandle);\r\n    },\r\n\r\n    idLogin () {\r\n        fun.log('login', 'idLogin');\r\n        let id = this.editBox.getComponent(cc.EditBox).string;\r\n        if (id.length !== 6) {\r\n            fun.log('login', `error id ${id}`);\r\n            return;\r\n        }\r\n        fun.net.pSend('GustLogin', {UserId: parseInt(id)}, this.loginHandle);\r\n    },\r\n\r\n    loginHandle (data) {\r\n        if (data.RetCode && data.RetCode !== 0) {\r\n            fun.log('login', 'login error: ', data);\r\n            switch(data.RetCode){\r\n                case 1: {\r\n                        let func = function(){\r\n                            this.wxLoginBtn.once('click', this.onLoginBtnClick, this);\r\n                        }.bind(this)\r\n                        fun.event.dispatch('MinSingleButtonPop', {okCb: func, contentStr: '服务器忙', closeCb: func});\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '非法游戏类型'});\r\n                    break;\r\n                case 3:\r\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '登录失败'});\r\n                    break;\r\n                case 4: {\r\n                        cc.sys.localStorage.removeItem('Token');\r\n                        fun.utils.restart();\r\n                    }\r\n                    break;\r\n                case 5:\r\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '非法第三方平台'});\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            return;\r\n        }\r\n        fun.net.setState('Login');\r\n        let userInfo = fun.db.getData('UserInfo');\r\n        if (userInfo.location !== undefined) {\r\n            data.location = userInfo.location;\r\n        } else {\r\n            data.location = null;\r\n        }\r\n        fun.db.setData('UserInfo', data);\r\n        cc.sys.localStorage.setItem('Token', data.Token);\r\n        cc.director.loadScene('hall');\r\n    },\r\n});\r\n"]}