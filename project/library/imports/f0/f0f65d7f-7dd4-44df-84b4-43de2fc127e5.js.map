{"version":3,"sources":["../../../../../../../assets/mahjong/script/game/common/assets/mahjong/script/game/common/mjDataMgr.js"],"names":["GameDefine","require","ServerToLocalType","gameData","userId","undefined","roomInfo","roomPlayers","PlayerCOORD","isRoomMaster","mjDataSys","data","CfgData","gameName","zhuangPaiCount","totalPai","liujupai","paiScale","MagicName","Dialect","TesuPai","SPECIALPAIHY","createDate","CREATROOMHY","canQuickly","PaiID","set","key","value","get","clean","initRoomPlayers","playerArray","i","length","playerData","isSelfPlayed","UserId","mjDataMgr","KEYS","UID","SELFID","PlayerIdx","refreshDeskType","setPlayerData","deskPosIdxs","meIdx","DESKPOS_TYPE","XIA","YOU","SHANG","ZUO","POSIDS","posIndex","isTruePlayer","showName","Name","sliceName","OnLine","Status","PLAYER_READY","OFFLINE","xdhs","Score","PLAYERS","getPlayerData","getAllPlayersData","setPlayerCOORD","idx","coord","playerCoords","COORDS","getPlayerCOORD","init","userInfo","fun","db","getData","CFG","initRoomInfo","getCeateItem","itemKey","dataKey","item","itemData","name","content","log","gameInfo","RoomInformation","showList","push","SpendMethod","GameNum","ROOMINFO","hymjData","PlayerInfo","Quan","Round","setData","ROOMID","RoomId","PlayersInfo","refreRoomCount","gameCountStr","cfgData","cc","slice","getLocalPaiID","id","localID","serverType","Math","floor","num","localType","isBaiBan","wlDataSys","isPuhua","SPECIALPAIWL","CREATROOMWL","SelfIdx","RoomOrder","Icon","HeadUrl","UserName","Ready","READY","NO_READY","Owner","JuShu","playInfoList","Array","Players","forEach","index","player","UserHeadUrl","Address","location","Sex","UserSex","scmjDataSys","CREATROOMSC","MoShi","moshi","moShiL","toString","substr","DingWeiN","DingWei","totalJu","hyReDataSys","oldData","players","icon","sex","hushu","prototype","instance","isReplay","dfDataList","gameConst","gameType","maJiangWenLing","maJiangHuangYan","scMahjong","curGameType","GameType","curDataSys","getInstance","module","exports"],"mappings":"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","file":"mjDataMgr.js","sourceRoot":"../../../../../../../assets/mahjong/script/game/common","sourcesContent":["var GameDefine = require(\"mjGameDefine\");\n//server 筒1条2万3字4风5\n//本地筒1万2条3特殊4\nvar ServerToLocalType = {\n    1 : 1,\n    2 : 3,\n    3 : 2,\n}\n\nvar gameData = {\n    userId      : undefined,\n    roomInfo    : {},\n    roomPlayers : {},\n    PlayerCOORD : {},\n    isRoomMaster: false,\n};\n\n\nvar mjDataSys = function(){\n    this.data = {\n        CfgData : {\n            gameName  : \"黄岩麻将\",\n            zhuangPaiCount : 14, //庄家牌的数量 \n            totalPai  : 136, //总共好多张牌\n            liujupai  : 14,  //当剩余牌数为这个数目的时候就是流局\n            paiScale  : 1,\n            MagicName :\"Caishen\",\n            Dialect   : \"hymj/\",\n        },\n        TesuPai : GameDefine.SPECIALPAIHY,\n        createDate : GameDefine.CREATROOMHY,\n    }\n    this.canQuickly = function(PaiID){\n        return true;\n    }\n    this.set = function(key,value){\n        this.data[key] = value;\n    }\n    this.get = function(key){\n        return this.data[key];\n    }\n    this.clean = function(){\n        this.data = {};\n    }\n    this.initRoomPlayers = function(playerArray){\n        for(let i = 0; i < playerArray.length; i++){\n            var playerData = playerArray[i];\n            if(!playerData) {continue;}\n            playerData.isSelfPlayed = false;\n            if(playerData.UserId == this.get(mjDataMgr.KEYS.UID)){\n                this.set(mjDataMgr.KEYS.SELFID, playerData.PlayerIdx);\n                this.refreshDeskType();\n                playerData.isSelfPlayed = true;\n            }\n            var PlayerIdx = playerData.PlayerIdx;\n            this.setPlayerData(playerData, PlayerIdx);\n        }\n    }\n    this.refreshDeskType = function(){\n        var deskPosIdxs = [];\n        var meIdx = this.get(mjDataMgr.KEYS.SELFID);\n        deskPosIdxs[meIdx]         = GameDefine.DESKPOS_TYPE.XIA;\n        deskPosIdxs[(meIdx + 1)%4] = GameDefine.DESKPOS_TYPE.YOU;\n        deskPosIdxs[(meIdx + 2)%4] = GameDefine.DESKPOS_TYPE.SHANG;\n        deskPosIdxs[(meIdx + 3)%4] = GameDefine.DESKPOS_TYPE.ZUO;\n        this.set(mjDataMgr.KEYS.POSIDS, deskPosIdxs);\n    }\n    this.setPlayerData = function(playerData, posIndex){\n         if(playerData){\n            var isTruePlayer        = true//playerData.Icon.length > 4; //正式玩家服务器会返回来玩家icon\n            playerData.showName     = isTruePlayer ? playerData.Name : \"游客\"+playerData.UserId;\n            playerData.showName     = mjDataMgr.sliceName(playerData.showName);\n            playerData.isTruePlayer = isTruePlayer;\n            playerData.OnLine       = (playerData.Status != GameDefine.PLAYER_READY.OFFLINE)\n            playerData.xdhs         = playerData.Score || 0;\n        }\n        var roomPlayers = this.get(mjDataMgr.KEYS.PLAYERS) || {};\n        roomPlayers[posIndex] = playerData;\n        this.set(mjDataMgr.KEYS.PLAYERS, roomPlayers); \n    }\n\n    this.getPlayerData = function(PlayerIdx){\n        return this.get(mjDataMgr.KEYS.PLAYERS)[PlayerIdx];\n    }\n\n    this.getAllPlayersData = function () {\n        return this.get(mjDataMgr.KEYS.PLAYERS);\n    }\n\n    this.setPlayerCOORD = function(idx, coord){\n        var playerCoords = this.get(mjDataMgr.KEYS.COORDS) || {};\n        playerCoords[idx] = coord;\n        this.set(mjDataMgr.KEYS.COORDS, playerCoords);\n    }\n\n    this.getPlayerCOORD = function(idx){\n        var playerCoords = this.get(mjDataMgr.KEYS.COORDS) || {};\n        return playerCoords[idx];\n    }\n\n    this.isRoomMaster = function(){\n        return this.get(mjDataMgr.KEYS.SELFID) == 0;\n    }\n    this.init = function(){\n        var userInfo = fun.db.getData('UserInfo');\n        this.set(mjDataMgr.KEYS.UID, userInfo.UserId);\n        this.set(mjDataMgr.KEYS.CFG, this.data.CfgData);\n        this.initRoomInfo();\n    }\n    this.getCeateItem = function(itemKey, roomInfo, dataKey){\n        var createDate = this.data.createDate;\n        var item       = this.data.createDate[itemKey];\n        dataKey        = dataKey ||  roomInfo[itemKey];\n        var itemData   = {};\n        if(item){\n            itemData.name    = item.name;\n            itemData.content = item.data[dataKey];\n        }else {\n            fun.log(\"mj\", \"mjDataMgr getCeateItem: this itemKey has no  defined\");\n        }\n        return itemData\n    }\n\n    this.initRoomInfo = function(){\n        var gameInfo = fun.db.getData('RoomInfo');\n        var roomInfo = gameInfo.RoomInformation;\n        roomInfo.showList = [];\n        roomInfo.showList.push(this.getCeateItem(\"GameNum\"+roomInfo.SpendMethod, roomInfo, roomInfo.GameNum));\n        roomInfo.showList.push(this.getCeateItem(\"PaymentMethod\", roomInfo));\n        // roomInfo.showList.push(this.getCeateItem(\"NoticeType\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"GshOp\", roomInfo));\n        this.set(mjDataMgr.KEYS.ROOMINFO, roomInfo)\n        var  hymjData    = fun.db.getData(\"hymajiang\");\n        if(hymjData.PlayerInfo){\n            //create room\n            roomInfo.Quan              = 1;\n            roomInfo.Round             = 0;\n            hymjData.PlayerInfo.OnLine = true;\n            this.initRoomPlayers([hymjData.PlayerInfo]);\n            fun.db.setData(\"hymajiang\", undefined);\n            this.set(mjDataMgr.KEYS.ROOMID, fun.db.getData('RoomInfo').RoomId);\n        }else {\n            //enter room\n            roomInfo.Quan              = 1;\n            roomInfo.Round             = 0;\n            this.initRoomPlayers(gameInfo.PlayersInfo);\n            this.set(mjDataMgr.KEYS.ROOMID, roomInfo.RoomId);\n        }\n        this.set(mjDataMgr.KEYS.ROOMINFO, roomInfo)\n        this.refreRoomCount();\n    }\n\n     this.refreRoomCount = function(){\n        var roomInfo = this.get(mjDataMgr.KEYS.ROOMINFO);\n        roomInfo.gameCountStr = \"\";\n        var cfgData  = this.data.createDate[\"GameNum\"+roomInfo.SpendMethod].data[roomInfo.GameNum];\n        cc.log(\"roomInfo \", roomInfo);\n        cfgData = cfgData.slice(0, -1);\n        if(roomInfo.SpendMethod == 1){\n            roomInfo.gameCountStr = roomInfo.Quan + \"/\" + cfgData + \"<color=#B1C3C4>\"+\"圈 \"+\"</c>\" + \n            roomInfo.Round +  \"<color=#B1C3C4>\"+\"局\"+\"</c>\";\n        }else {\n            roomInfo.gameCountStr = roomInfo.Round + \"/\" + cfgData + \"<color=#B1C3C4>\"+\"局 \"+\"</c>\"\n        }\n       \n    }\n\n\n    this.getLocalPaiID = function(id){\n        var localID    = this.data.TesuPai[id];\n        if(!localID){\n            var serverType = Math.floor(id/10);\n            var num        = id - serverType* 10;\n            var localType  = ServerToLocalType[serverType];\n            localID        = num * 10 + localType; \n        }\n        return localID;\n    }\n\n    this.isBaiBan = function(id) {\n        var localID = this.getLocalPaiID(id);\n        return (localID == 14)\n    }\n\n}\n\nvar wlDataSys = function(){\n    this.data = {\n        CfgData    : {\n            gameName      : \"温岭麻将\",\n            zhuangPaiCount: 17, //庄家牌的数量 \n            totalPai      : 144, //总共好多张牌\n            liujupai      : 14,  //当剩余牌数为这个数目的时候就是流局\n            paiScale      : 0.84,\n            isPuhua       : true,\n            MagicName     :\"Caishen\",\n            Dialect       : \"wlmj/\",\n        },\n        TesuPai : GameDefine.SPECIALPAIWL,\n        createDate : GameDefine.CREATROOMWL,\n    }\n\n    this.canQuickly = function(PaiID){\n        //最开始温岭财神不能打，后来又能打\n        // var gameManager = require('mjGameManager');\n        // return (gameManager.CaiShenPai.indexOf(PaiID) == -1)\n        return true;\n    }\n\n    this.initRoomPlayers = function(playerArray){\n        let SelfIdx = 0;\n        for(let i = 0; i < playerArray.length; i++){\n            var playerData = playerArray[i];\n            if(!playerData) {continue;}\n            playerData.isSelfPlayed = false;\n            // cc.log(\"---mjDataMgr.KEYS.UID---\", this.get(mjDataMgr.KEYS.UID, playerData));\n            if(playerData.UserId == this.get(mjDataMgr.KEYS.UID)){\n                SelfIdx = i;\n            }\n            var PlayerIdx        = playerData.RoomOrder;\n            playerData.PlayerIdx = PlayerIdx;\n            this.setPlayerData(playerData, PlayerIdx);\n        }\n        var playerData = this.getPlayerData(SelfIdx);\n        this.set(mjDataMgr.KEYS.SELFID, playerData.RoomOrder);\n        this.refreshDeskType();\n        playerData.isSelfPlayed = true;\n    }\n    this.setPlayerData = function(playerData, posIndex){\n         if(playerData){\n            cc.log(\"setPlayerData\", playerData);\n            var roomInfo            = this.get(mjDataMgr.KEYS.ROOMINFO)\n            playerData.Icon         = playerData.HeadUrl || \"\";\n            var isTruePlayer        = true//playerData.Icon.length > 4; //正式玩家服务器会返回来玩家icon\n            playerData.name         = playerData.UserName || playerData.Name;\n            playerData.showName     = isTruePlayer ? playerData.name : \"游客\" +  playerData.UserId;\n            playerData.showName     = mjDataMgr.sliceName(playerData.showName);\n            playerData.isTruePlayer = isTruePlayer;\n            playerData.xdhs         = playerData.Score || 0;\n            playerData.Status       = playerData.Ready ? GameDefine.PLAYER_READY.READY : GameDefine.PLAYER_READY.NO_READY;\n\n        }\n        var roomPlayers = this.get(mjDataMgr.KEYS.PLAYERS) || {};\n        roomPlayers[posIndex] = playerData;\n        this.set(mjDataMgr.KEYS.PLAYERS, roomPlayers); \n    }\n    this.isRoomMaster = function(){\n        //wengling 先暂时都是离开房间\n        // return this.get(mjDataMgr.KEYS.UID) == this.get(mjDataMgr.KEYS.ROOMINFO).Owner;\n        // return false;\n\n        return this.get(mjDataMgr.KEYS.UID) == this.get(mjDataMgr.KEYS.ROOMINFO).Owner.UserId;\n    }\n\n    this.initRoomInfo = function(){\n        var roomInfo = fun.db.getData('RoomInfo');\n        var createDate = this.data.createDate;\n        roomInfo.showList = [];\n        roomInfo.showList.push(this.getCeateItem(\"MoShi\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"JuShu\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"ShengPaiTime\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"ZhiFu\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"WanFa\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"RenShu\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"BaoPai\", roomInfo));\n        roomInfo.GameNum = roomInfo.JuShu;\n        roomInfo.Round   = roomInfo.Round || 0;\n        roomInfo.Quan    = roomInfo.Quan || 0;\n        var playInfoList = new Array(4);\n        if(roomInfo.Players){\n             //enter room\n            roomInfo.Players.forEach(function(item, index){\n                playInfoList[item.RoomOrder] = item;\n            })\n        }else {\n            //create room\n            var player       = fun.db.getData('UserInfo');\n            player.Status    = GameDefine.PLAYER_READY.NO_READY;\n            player.OnLine    = true;\n            player.RoomOrder = roomInfo.Owner.RoomOrder;\n            player.HeadUrl   = player.UserHeadUrl;\n            player.Address   = player.location;\n            player.Sex       = player.UserSex\n            playInfoList[roomInfo.Owner.RoomOrder] = player;\n        }\n        this.initRoomPlayers(playInfoList);\n        this.set(mjDataMgr.KEYS.ROOMINFO, roomInfo)\n        this.set(mjDataMgr.KEYS.ROOMID, roomInfo.RoomId);\n        this.refreRoomCount();\n    }\n\n    this.refreRoomCount = function(){\n        var roomInfo = this.get(mjDataMgr.KEYS.ROOMINFO);\n        roomInfo.gameCountStr = \"\";\n        var cfgData  = this.data.createDate.JuShu.data[roomInfo.JuShu];\n         cc.log(\"roomInfo \", roomInfo);\n        cfgData = cfgData.slice(0, -1);\n        if(roomInfo.JuShu > 20){\n            roomInfo.gameCountStr = roomInfo.Round + \"/\" + cfgData + \"<color=#B1C3C4>\"+\"局\"+\"</c>\";\n        }else {\n            roomInfo.gameCountStr = roomInfo.Quan + \"/\" + cfgData + \"<color=#B1C3C4>\"+\"圈 \"+\"</c>\" + \n                 roomInfo.Round +  \"<color=#B1C3C4>\"+\"局\"+\"</c>\";\n        }\n    }\n}\n\nlet scmjDataSys = function() {\n    this.data = {\n        CfgData: {\n            gameName: \"四川麻将\",\n            zhuangPaiCount: 13, //庄家牌的数量 \n            totalPai: 108, //总共好多张牌\n            liujupai: 0,  //当剩余牌数为这个数目的时候就是流局\n            paiScale: 0.84,\n            isPuhua: true,\n            Dialect: \"scmj/\",\n        },\n        createDate: GameDefine.CREATROOMSC,\n    }\n    this.initRoomPlayers = function (playerArray) {\n        let SelfIdx = 0;\n        for (let i = 0; i < playerArray.length; i++) {\n            var playerData = playerArray[i];\n            if (!playerData) { continue; }\n            playerData.isSelfPlayed = false;\n            // cc.log(\"---mjDataMgr.KEYS.UID---\", this.get(mjDataMgr.KEYS.UID, playerData));\n            if (playerData.UserId == this.get(mjDataMgr.KEYS.UID)) {\n                SelfIdx = i;\n            }\n            var PlayerIdx = playerData.RoomOrder;\n            playerData.PlayerIdx = PlayerIdx;\n            this.setPlayerData(playerData, PlayerIdx);\n        }\n        var playerData = this.getPlayerData(SelfIdx);\n        this.set(mjDataMgr.KEYS.SELFID, playerData.RoomOrder);\n        this.refreshDeskType();\n        playerData.isSelfPlayed = true;\n    }\n    this.setPlayerData = function (playerData, posIndex) {\n        if (playerData) {\n            var roomInfo = this.get(mjDataMgr.KEYS.ROOMINFO)\n            playerData.Icon = playerData.HeadUrl || \"\";\n            var isTruePlayer = true//playerData.Icon.length > 4; //正式玩家服务器会返回来玩家icon\n            playerData.name = playerData.UserName || playerData.Name;\n            playerData.showName = isTruePlayer ? playerData.name : \"游客\" + playerData.UserId;\n            playerData.showName = mjDataMgr.sliceName(playerData.showName);\n            playerData.isTruePlayer = isTruePlayer;\n            playerData.xdhs = playerData.Score || 0;\n            playerData.Status = playerData.Ready ? GameDefine.PLAYER_READY.READY : GameDefine.PLAYER_READY.NO_READY;\n\n        }\n        var roomPlayers = this.get(mjDataMgr.KEYS.PLAYERS) || {};\n        roomPlayers[posIndex] = playerData;\n        this.set(mjDataMgr.KEYS.PLAYERS, roomPlayers);\n    }\n    this.isRoomMaster = function () {\n        return this.get(mjDataMgr.KEYS.UID) == this.get(mjDataMgr.KEYS.ROOMINFO).Owner.UserId;\n    }\n\n    this.initRoomInfo = function () {\n        var roomInfo = fun.db.getData('RoomInfo');\n        var createDate = this.data.createDate;\n        cc.log('--- createDate: ', createDate);\n        cc.log('--- createDate.MoShi: ', createDate.MoShi);\n        let moshi = { name: createDate.MoShi.name, content: ''};\n        let moShiL = '';\n        for (let i = 0; i < roomInfo.MoShi.toString().length; ++i) {\n            cc.log('--- i: ', i);\n            moShiL = moShiL + createDate.MoShi.data[i][roomInfo.MoShi.substr(i, 1)];\n            cc.log('--- moshiL : ', moShiL);\n        }\n        cc.log('--- moshiL2 : ', moShiL);\n        roomInfo.showList = [];\n        roomInfo.showList.push(this.getCeateItem(\"WanFa\", roomInfo));\n        // roomInfo.showList.push(this.getCeateItem(\"MoShi\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"FengDing\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"DiFen\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"FangFei\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"GuiZe\", roomInfo));\n        cc.log('--- sxxsss : ', this.getCeateItem(\"JuShu\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"JuShu\", roomInfo));\n        roomInfo.DingWeiN = roomInfo.DingWei ? 1 : 0;\n        roomInfo.showList.push(this.getCeateItem(\"DingWei\", roomInfo));\n        roomInfo.GameNum = roomInfo.JuShu;\n        roomInfo.Round = roomInfo.Round || 0;\n        var playInfoList = new Array(4);\n        if (roomInfo.Players) {\n            //enter room\n            roomInfo.Players.forEach(function (item, index) {\n                playInfoList[item.RoomOrder] = item;\n            })\n        } else {\n            //create room\n            var player = fun.db.getData('UserInfo');\n            player.Status = GameDefine.PLAYER_READY.NO_READY;\n            player.OnLine = true;\n            player.RoomOrder = roomInfo.Owner;\n            player.HeadUrl = player.UserHeadUrl;\n            player.Address = player.location;\n            player.Sex = player.UserSex\n            playInfoList[roomInfo.Owner] = player;\n        }\n        this.initRoomPlayers(playInfoList);\n        this.set(mjDataMgr.KEYS.ROOMINFO, roomInfo)\n        this.set(mjDataMgr.KEYS.ROOMID, roomInfo.RoomId);\n        this.refreRoomCount();\n    }\n\n    this.refreRoomCount = function () {\n        var roomInfo = this.get(mjDataMgr.KEYS.ROOMINFO);\n        roomInfo.gameCountStr = \"\";\n        let totalJu = roomInfo.JuShu;\n        roomInfo.gameCountStr = roomInfo.Round + \"/\" + totalJu + \"<color=#B1C3C4>\" + \"局\" + \"</c>\";\n    }\n\n}\n\n//黄岩回放\nvar hyReDataSys = function(){\n    var oldData = new mjDataSys();\n    this.data    = oldData.data;    \n\n    // this.data.CfgData.paiScale = 1.1;\n    this.initRoomInfo = function(){\n        var gameInfo = fun.db.getData('RoomInfo');\n        var roomInfo = gameInfo.RoomInformation || {};\n        roomInfo.showList = [];\n         roomInfo.showList.push(this.getCeateItem(\"GameNum\"+roomInfo.SpendMethod, roomInfo, roomInfo.GameNum));\n        roomInfo.showList.push(this.getCeateItem(\"PaymentMethod\", roomInfo));\n        // roomInfo.showList.push(this.getCeateItem(\"NoticeType\", roomInfo));\n        roomInfo.showList.push(this.getCeateItem(\"GshOp\", roomInfo));\n        roomInfo.gameCountStr = \"\";\n        this.set(mjDataMgr.KEYS.ROOMINFO, roomInfo)\n        this.set(mjDataMgr.KEYS.ROOMID, gameInfo.RoomId)\n        this.initRoomPlayers(gameInfo);\n    }\n\n    this.initRoomPlayers = function(gameInfo){\n        var playerArray = gameInfo.players\n        var meIdx = gameInfo.meIdx;\n        for(let i = 0; i < playerArray.length; i++){\n            var playerData = playerArray[i];\n            playerData.isSelfPlayed = (i==meIdx);\n            if(i == 0){\n                this.set(mjDataMgr.KEYS.SELFID, meIdx);\n                this.refreshDeskType();\n            }\n            this.setPlayerData(playerData, i);\n        }\n    }\n\n    this.setPlayerData = function(playerData, posIndex){\n        playerData.Icon         = playerData.icon;\n        playerData.UserId       = playerData.id;\n        var isTruePlayer        = true//playerData.Icon.length > 4; //正式玩家服务器会返回来玩家icon\n        playerData.showName     = isTruePlayer ? playerData.name : \"游客\"+playerData.UserId;\n        playerData.showName     = mjDataMgr.sliceName(playerData.showName);\n        playerData.isTruePlayer = isTruePlayer;\n        playerData.OnLine       = true;\n        playerData.Sex          = playerData.sex   || playerData.Sex;\n        playerData.xdhs         = playerData.hushu;\n        var roomPlayers = this.get(mjDataMgr.KEYS.PLAYERS) || {};\n        roomPlayers[posIndex] = playerData;\n        this.set(mjDataMgr.KEYS.PLAYERS, roomPlayers); \n    }\n    this.refreRoomCount = function(){\n        var roomInfo = this.get(mjDataMgr.KEYS.ROOMINFO);\n        roomInfo.gameCountStr = \"\";\n    }\n\n}\n\nwlDataSys.prototype = new mjDataSys();\nhyReDataSys.prototype = new mjDataSys();\nscmjDataSys.prototype = new mjDataSys();\n\n\nvar instance;\nvar mjDataMgr  = {\n    init : function(isReplay=false){\n        var dfDataList                                 = {}\n        dfDataList[gameConst.gameType.maJiangWenLing]  =  wlDataSys;\n        if (isReplay) {\n            dfDataList[gameConst.gameType.maJiangHuangYan] =  hyReDataSys;\n        } else {\n            dfDataList[gameConst.gameType.maJiangHuangYan] =  mjDataSys;\n        }\n        dfDataList[gameConst.gameType.scMahjong] = scmjDataSys;\n        \n        var roomInfo    = fun.db.getData('RoomInfo');\n        var curGameType = roomInfo.GameType\n        var curDataSys  = dfDataList[curGameType];\n        if(curDataSys){\n            instance = new curDataSys();\n            instance.init();\n        }else {\n            fun.log(\"mj\", \"mjDataMgr has no cur gameType : \" + curGameType);\n        }\n    },\n\n    getInstance : function(){\n        return instance;\n    },\n\n    KEYS : {\n        UID     : \"UserID\",\n        SELFID  : \"SelfIdx\",\n        ROOMID  : \"RoomID\",\n        ROOMINFO: \"RoomInfo\",\n        COORDS  : \"CoordList\",\n        POSIDS  : \"IDPosList\",\n        PLAYERS : \"RoomPlayers\",\n        CFG     : \"GameCfg\",\n    }, \n    get : function(key){\n        return this.getInstance().get(key);\n    },\n    set : function(key, value){\n        this.getInstance().set(key, value)\n    },\n\n    sliceName : function(name=\"\"){\n        if(name.length > 8){\n            name = name.slice(0, 8);\n        }\n        return name;\n    },\n}\n\nmodule.exports = mjDataMgr;"]}