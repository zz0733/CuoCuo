{"version":3,"sources":["../../../../../../../assets/mahjong/script/wahua/desk/assets/mahjong/script/wahua/desk/gameMgrWahua.js"],"names":["WhUtils","require","WhDefine","cc","Class","extends","Component","properties","btnExit","type","Node","default","btnReady","btnInvite","paiMianAltas","SpriteAtlas","onLoad","fun","event","dispatch","flag","net","setGameMsgCfg","_userId","db","getData","UserId","toString","roomInfo","_gameStatu","roomRule","gameStatu","_isRoomOwner","roomOwner","_playerNum","playerNum","_seat","Array","_seatDir","on","onBtnExitClick","onBtnReadyClick","onBtnInviteClick","registerListener","start","reconnet","escapeFlowerN","node","getChildByName","onBtnTaohuaClick","bind","pListen","onEnterRoomIn","onOffLineIn","onOnLineIn","listen","onDisbandRoomIn","onReadyIn","onReadyNextIn","onDisbandRoomVoteIn","onDisbandRoomResultIn","onBankerIn","onRockCardIn","onUserRefreshIn","onNoneOpsIn","onStartGameIn","onPlayCardIn","onDrawCardIn","onOpsAcceptIn","onRepairCardIn","onOneAccountIn","onQuitRoomIn","onAllAccountIn","onEscapeFlowerIn","add","data","showCardById","setSortByCards","_xiaCards","updateSeats","removeListener","rmPListen","rmListen","remove","onDestroy","p","ui","getComponent","pos","id","userId","undefined","getSeatByUserId","i","length","userMap","selfReadyState","currentState","setReadyState","nowZhuangjia","setJiaWeiShow","rollChessDice","showYaoZhang","seat","chessCard","alreadyChess","chessNum","alreadyChessNum","overChess","chuPai","buhuaChess","setBuhuaText","gangAndEatChess","setChiGang","yaozhang","isReconnet","yzNode","yz","getCardById","yzCard","Sprite","spriteFrame","getSpriteFrame","active","cards","setCardShow","setEscapeFlowerShow","send","isRunaway","tSeat","tPos","newSeat","curPos","dir","cha","setDirect","rsp","exitRoom","applyStatu","returnStatu","ready","showReady","log","key","userOneMap","setData","Zhuangjia","szCallback","szCard","szPoint","getSaiziPointByCard","point","callback","InitCardsNumber","playChessUser","hint","showQuan","playChess","fetchChess","playGetChessUser","cardArr","push","moPai","isHu","other_chess","setHu","isReplaceWhite","setHuan","buhua_player","buhuaReplaceWhiteChess","j","id1","id2","state","name","userName","headUrl","UserHeadUrl","breakStatu","parseInt","outLine","userInfo","RoomId","director","loadScene"],"mappings":"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","file":"gameMgrWahua.js","sourceRoot":"../../../../../../../assets/mahjong/script/wahua/desk","sourcesContent":["const WhUtils = require('whUtils');\nconst WhDefine = require('whDefine');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnExit: {\n            type: cc.Node,\n            default: null,\n        },\n\n        btnReady: {\n            type: cc.Node,\n            default: null,\n        },\n\n        btnInvite: {\n            type: cc.Node,\n            default: null,\n        },\n\n        paiMianAltas: {\n            type: cc.SpriteAtlas,\n            default: null,\n        },\n    },\n\n    onLoad () {\n        fun.event.dispatch('Zhuanquan', { flag: false });\n        fun.net.setGameMsgCfg(require('WahuaCfg'));\n        this._userId = fun.db.getData('UserInfo').UserId.toString();\n        let roomInfo = fun.db.getData('RoomInfo');\n        this._gameStatu = roomInfo.roomRule.gameStatu;\n        this._isRoomOwner = (this._userId === roomInfo.roomRule.roomOwner);\n        this._playerNum = roomInfo.roomRule.playerNum;\n        this._seat = new Array();\n        this._seatDir = ['xia', 'you', 'shang', 'zuo'];\n\n        this.btnExit.on('click', this.onBtnExitClick, this);\n        this.btnReady.on('click', this.onBtnReadyClick, this);\n        this.btnInvite.on('click', this.onBtnInviteClick, this);\n        this.registerListener();\n    },\n\n    start() {\n        this.reconnet();\n        this.escapeFlowerN = this.node.getChildByName('guo');\n        this.escapeFlowerN.getChildByName('taohua').on('click', this.onBtnTaohuaClick.bind(this, 1));\n        this.escapeFlowerN.getChildByName('guo').on('click', this.onBtnTaohuaClick.bind(this, 2));\n    },\n\n    registerListener() {\n        fun.net.pListen('EnterRoom', this.onEnterRoomIn.bind(this));\n        fun.net.pListen('OffLine', this.onOffLineIn.bind(this));\n        fun.net.pListen('OnLine', this.onOnLineIn.bind(this));\n        fun.net.listen('DisbandRoom', this.onDisbandRoomIn.bind(this));\n        fun.net.listen('Ready', this.onReadyIn.bind(this));\n        fun.net.listen('ReadyNext', this.onReadyNextIn.bind(this));\n        fun.net.listen('DisbandRoomVote', this.onDisbandRoomVoteIn.bind(this));\n        fun.net.listen('DisbandRoomResult', this.onDisbandRoomResultIn.bind(this));\n        fun.net.listen('Banker', this.onBankerIn.bind(this));\n        fun.net.listen('RockCard', this.onRockCardIn.bind(this));\n        fun.net.listen('UserRefresh', this.onUserRefreshIn.bind(this));\n        fun.net.listen('NoneOps', this.onNoneOpsIn.bind(this));\n        fun.net.listen('StartGame', this.onStartGameIn.bind(this));\n        fun.net.listen('PlayCard', this.onPlayCardIn.bind(this));\n        fun.net.listen('DrawCard', this.onDrawCardIn.bind(this));\n        fun.net.listen('OpsAccept', this.onOpsAcceptIn.bind(this));\n        fun.net.listen('RepairCard', this.onRepairCardIn.bind(this));\n        fun.net.listen('OneAccount', this.onOneAccountIn.bind(this));\n        fun.net.listen('QuitRoom', this.onQuitRoomIn.bind(this));\n        fun.net.listen('AllAccount', this.onAllAccountIn.bind(this));\n        fun.net.listen('EscapeFlower', this.onEscapeFlowerIn.bind(this));\n\n        fun.event.add('gameMgrWahuaNeedReSortCards', 'whNeedReSortCards', function (data) {\n            this.showCardById(this._userId, WhUtils.setSortByCards(data));\n        }.bind(this));\n        fun.event.add('gameMgrWahuaUpdatedCards', 'whUpdatedCards', function(data){\n            this._xiaCards = data; \n        }.bind(this));\n        fun.event.add('gameMgrWahuaInitCompleted', 'wahuaInitCompleted', this.updateSeats.bind(this));\n        fun.event.add('gameMgrWahuaQuitFromSetting', 'wahuaQuitFromSetting', this.onBtnExitClick.bind(this));\n    },\n    removeListener() {\n        fun.net.rmPListen('EnterRoom');\n        fun.net.rmPListen('OffLine');\n        fun.net.rmPListen('OnLine');\n        fun.net.rmListen('DisbandRoom');\n        fun.net.rmListen('Ready');\n        fun.net.rmListen('ReadyNext');\n        fun.net.rmListen('DisbandRoomVote');\n        fun.net.rmListen('DisbandRoomResult');\n        fun.net.rmListen('Banker');\n        fun.net.rmListen('RockCard');\n        fun.net.rmListen('UserRefresh');\n        fun.net.rmListen('NoneOps');\n        fun.net.rmListen('StartGame');\n        fun.net.rmListen('PlayCard');\n        fun.net.rmListen('DrawCard');\n        fun.net.rmListen('OpsAccept');\n        fun.net.rmListen('RepairCard');\n        fun.net.rmListen('OneAccount');\n        fun.net.rmListen('QuitRoom');\n        fun.net.rmListen('AllAccount');\n        fun.net.rmListen('EscapeFlower');\n\n        fun.event.remove('gameMgrWahuaNeedReSortCards');\n        fun.event.remove('gameMgrWahuaUpdatedCards');\n        fun.event.remove('gameMgrWahuaInitCompleted');\n        fun.event.remove('gameMgrWahuaQuitFromSetting');\n    },\n\n    onDestroy() {\n        this.removeListener();\n        this._seat = [];\n        this._seatDir = [];\n        this._xiaCards = [];\n    },\n\n    updateSeats(p) {\n        if (!p && p !== 0) return;\n        this._seat[p] = {};\n        this._seat[p].ui = this.node.getChildByName(this._seatDir[p]).getComponent('playerUiWahua');\n        this._seat[p].pos = p;\n        this._seat[p].id = this._seat[p].ui.data ? this._seat[p].ui.data.userId : undefined;\n        // cc.log('--- this._seat: ', this._seat);\n    },\n\n    getSeatByUserId(id) {\n        for (let i=0; i<this._seat.length; ++i) {\n            if (this._seat[i] && this._seat[i].id && this._seat[i].id === id) {\n                return this._seat[i];\n            }\n        }\n    },\n\n    reconnet() {\n        let roomInfo = fun.db.getData('RoomInfo');\n        if(!roomInfo.userMap) return;\n        let roomRule = roomInfo.roomRule;\n        let userMap = roomInfo.userMap;\n        let selfReadyState = userMap[this._userId].currentState;\n        this.setReadyState(selfReadyState === 0 ? true : false);\n        if (roomRule.nowZhuangjia) {\n            this.setJiaWeiShow(roomRule.nowZhuangjia);\n        }\n        if (roomRule.rollChessDice) {\n            this.showYaoZhang(roomRule.rollChessDice, true);\n        }\n        for (let id in userMap) {\n            let seat = this.getSeatByUserId(id);\n            let chessCard = userMap[id].alreadyChess;\n            let chessNum = userMap[id].alreadyChessNum;\n            let overChess = userMap[id].overChess;\n            if (chessCard) {\n                this.showCardById(id, WhUtils.setSortByCards(chessCard));\n            } else if (chessNum && chessNum !== 0) {\n                this.showCardById(id, chessNum);\n            }\n            if (overChess && overChess.length !== 0) {\n                for (let i = 0; i < overChess.length; ++i) {\n                    seat.ui.chuPai(overChess[i]);\n                }\n            }\n            let buhuaChess = userMap[id].buhuaChess;\n            if (buhuaChess && buhuaChess.length !== 0) {\n                seat.ui.setBuhuaText(buhuaChess.length);\n            }\n            let gangAndEatChess = userMap[id].gangAndEatChess;\n            if (gangAndEatChess && gangAndEatChess.length !== 0) {\n                for (let i = 0; i < gangAndEatChess.length; ++i) {\n                    seat.ui.setChiGang(gangAndEatChess[i]);\n                }\n            }\n        }\n    },\n\n    showYaoZhang(yaozhang, isReconnet) {\n        let yzNode = this.node.getChildByName('yaozhang');\n        for (let i=0; i<yaozhang.length; ++i) {\n            let yz = WhUtils.getCardById(yaozhang[i]);\n            let yzCard = yzNode.getChildByName('card'+(i+1)).getComponent(cc.Sprite);\n            yzCard.spriteFrame = this.paiMianAltas.getSpriteFrame(yz);\n        }\n        if (isReconnet) {\n            yzNode.active = true;\n        }\n    },\n\n    showCardById(id, cards) {\n        let seat = this.getSeatByUserId(id);\n        if(!seat) return;\n        seat.ui.setCardShow(cards);\n    },\n\n    setEscapeFlowerShow(flag) {\n        this.escapeFlowerN.active = flag;\n    },\n\n    onBtnTaohuaClick(type) {\n        fun.net.send('EscapeFlower', { isRunaway: type});\n        this.setEscapeFlowerShow(false);\n    },\n\n    setReadyState(flag) {\n        this.btnReady.active = flag;\n        if (this._gameStatu === 1) return;\n        this.btnInvite.active = false;\n        this.btnExit.active = false;\n    },\n\n    setJiaWeiShow(id) {\n        this.node.getChildByName('roomDescScrollView').active = false;\n        let tSeat = this.getSeatByUserId(id);\n        let tPos = tSeat.pos;\n        let newSeat = new Array(); // 0-天家 1-地家 2-银牌 3-长三\n        for (let i=0; i<this._seat.length; ++i) {\n            if (this._seat[i]) {\n                let curPos = this._seat[i].pos;\n                let dir = 0;\n                let cha = curPos - tPos;\n                if (cha === 1 || cha === -3) {\n                    dir = 1;\n                } else if (cha === 2 || cha === -2) {\n                    dir = 2;\n                } else if (cha === 3 || cha === -1) {\n                    dir = 3;\n                } else {\n                    dir = 0;\n                }\n                newSeat[dir] = this._seat[i];\n            }\n        }\n        for (let dir=0; dir<newSeat.length; ++dir) {\n            if (newSeat[dir]) {\n                newSeat[dir].ui.setDirect(dir);\n            }\n        }\n    },\n\n    onBtnExitClick() {\n        if (this._gameStatu === 1) {\n            if (this._isRoomOwner) {\n                fun.net.send('DisbandRoom', {}, function(rsp) {\n                    this.exitRoom();\n                }.bind(this));\n            } else {\n                fun.net.send('QuitRoom', {}, function(rsp) {\n                    this.exitRoom();\n                }.bind(this));\n            }\n        } else {\n            fun.net.send('DisbandRoomVote', {applyStatu: 0});\n        }\n    },\n\n    onBtnReadyClick() {\n        fun.net.send('Ready', {}, function(rsp) {\n            if (rsp.returnStatu && rsp.returnStatu === 1) {\n                let seat = this.getSeatByUserId(rsp.ready);\n                if (!seat) return;\n                seat.ui.showReady(true);\n                this.setReadyState(false);\n            }\n        }.bind(this));\n    },\n    onBtnInviteClick() {\n        cc.log('--- invite ---')\n    },\n\n    onEnterRoomIn(data) {\n        let roomInfo = fun.db.getData('RoomInfo');\n        if (!roomInfo.userMap) {\n            roomInfo.userMap = {};\n        }\n        for (const key in data.userOneMap) {\n            if (key === 'userId') {\n                roomInfo.userMap[data.userOneMap.userId] = data.userOneMap;\n                fun.db.setData('RoomInfo', roomInfo);\n                return;\n            }\n        }\n    },\n\n    onReadyIn(data) {\n        if (!data.ready) return;\n        let seat = this.getSeatByUserId(data.ready);\n        if (!seat) return;\n        seat.ui.showReady(true);\n    },\n\n    onReadyNextIn(data) {\n        this.setReadyState(true);\n    },\n\n    onBankerIn(data) {\n        this._gameStatu = 2;\n        this.setJiaWeiShow(data.Zhuangjia);\n        this.setReadyState(false);\n        for(let i=0; i<this._seat.length; ++i){\n            if (this._seat[i]) {\n                this._seat[i].ui.showReady(false);\n            }\n        }\n    },\n\n    onRockCardIn(data) {\n        let yzNode = this.node.getChildByName('yaozhang');\n        this.showYaoZhang(data.rollChessDice);\n        let szCallback = function(){\n            yzNode.active = true;\n        };\n        let szCard = WhUtils.getCardById(data.rollChessDice[0]);\n        let szPoint = WhUtils.getSaiziPointByCard(szCard);\n        fun.event.dispatch('wahuaSaiziEnd', {point: szPoint, callback: szCallback});\n    },\n\n    onUserRefreshIn(data) {\n        cc.log('onUserRefreshIn--------');\n    },\n\n    onNoneOpsIn(data) {\n        cc.log('onNoneOpsIn--------');\n    },\n\n    onStartGameIn(data) {\n        this.setEscapeFlowerShow(true);\n        this.showCardById(this._userId, WhUtils.setSortByCards(data.alreadyChess));\n        for (let i=0; i<this._seat.length; ++i) {\n            if (this._seat[i] && this._seat[i].id && this._seat[i].id !== this._userId) {\n                this._seat[i].ui.setCardShow(WhDefine.InitCardsNumber);\n            }\n        }\n    },\n\n    onEscapeFlowerIn(data) {\n        this.setEscapeFlowerShow(true);\n    },\n\n    onPlayCardIn(data) {\n        if (data.playChessUser) {\n            let seat = this.getSeatByUserId(data.playChessUser);\n            if (data.hint && data.playChessUser !== this._userId) {\n                seat.ui.showQuan();\n            } else {\n                seat.ui.chuPai(data.playChess, true);\n            }\n        }\n    },\n\n    onDrawCardIn(data) {\n        if (data.fetchChess && data.playGetChessUser === this._userId) {\n            cc.log('--- xia 摸牌 ---');\n            this._xiaCards.cardArr.push(data.fetchChess);\n        }\n        let seat = this.getSeatByUserId(data.playGetChessUser);\n        seat.ui.moPai(data.fetchChess);\n    },\n\n    onOpsAcceptIn(data) {\n        if (data.hint && data.hint === 1) {\n            fun.event.dispatch('wahuaOpsEvent', data);\n        } else {\n            if (data.isHu) {\n                for (let id in data.other_chess) {\n                    cc.log('--- id, card: ', id, data.other_chess[id]);\n                    let seat = this.getSeatByUserId(id);\n                    cc.log('--- seat: ', seat);\n                    seat.ui.setHu(data.other_chess[id]);\n                }\n                return;\n            }\n            let seat = this.getSeatByUserId(data.playChessUser);\n            if (data.isReplaceWhite) {\n                seat.ui.setHuan(data.playChess);\n            } else {\n                seat.ui.setChiGang(data.playChess, true);\n            }\n        }\n    },\n\n    onRepairCardIn(data) {\n        if (!data.buhuaChess || !data.buhua_player) return;\n        let seat = this.getSeatByUserId(data.buhua_player);\n        seat.ui.setBuhuaText(data.buhuaChess.length);\n        if (!data.buhuaReplaceWhiteChess) return;\n        for (let i = 0; i < data.buhuaChess.length; ++i) {\n            for (let j = 0; j < this._xiaCards.cardArr.length; ++j) {\n                if (data.buhuaChess[i] === this._xiaCards.cardArr[j]) {\n                    this._xiaCards.cardArr[j] = data.buhuaReplaceWhiteChess[i];\n                }\n            }\n        }\n        this.showCardById(data.buhua_player, WhUtils.setSortByCards(this._xiaCards.cardArr));\n    },\n\n    onOneAccountIn(data) {\n        cc.log('onOneAccountIn--------');\n    },\n\n    onAllAccountIn(data) {\n        cc.log('onAllAccountIn--------');\n    },\n\n    onDisbandRoomIn(data) {\n        this.exitRoom();\n    },\n\n    onQuitRoomIn(data) {\n        let roomInfo = fun.db.getData('RoomInfo');\n        delete roomInfo.userMap[data.userId];\n        fun.db.setData('RoomInfo', roomInfo);\n    },\n\n    onDisbandRoomVoteIn(data) {\n        if (this.applyStatu) {\n            for (let id1 in this.applyStatu) {\n                for (let id2 in data.applyStatu) {\n                    if (id1 === id2) {\n                        this.applyStatu[id1].state = data.applyStatu[id2];\n                    }\n                }\n            }\n        } else {\n            this.applyStatu = {};\n            for (let i=0; i<this._seat.length; ++i) {\n                for (let id in data.applyStatu) {\n                    let seat = this._seat[i];\n                    if (seat && seat.id && seat.id === id) {\n                        this.applyStatu[id] = {};\n                        this.applyStatu[id].state = data.applyStatu[id];\n                        this.applyStatu[id].name = seat.ui.data.userName;\n                        this.applyStatu[id].headUrl = seat.ui.data.UserHeadUrl;\n                    }\n                }\n            }\n        }\n        data.applyStatu = this.applyStatu;\n        fun.event.dispatch('wahuaDisbandRoom', data);\n    },\n\n    onDisbandRoomResultIn(data) {\n        if (data.breakStatu && data.breakStatu === 1) {\n            this.exitRoom();\n        } else if (data.breakStatu && data.breakStatu === 2) {\n            fun.event.dispatch('wahuaDisbandRoom', false);\n        }\n    },\n\n    onOffLineIn(data) {\n        fun.event.dispatch('OffLineState', {flag: true, userId: parseInt(data.outLine)});\n    },\n\n    onOnLineIn(data) {\n        fun.event.dispatch('OffLineState', {flag: false, userId: parseInt(data.userId)});\n    },\n\n    exitRoom() {\n        let userInfo = fun.db.getData('UserInfo');\n        userInfo.RoomId = 0;\n        fun.db.setData('UserInfo', userInfo);\n        cc.director.loadScene('hall');\n    },\n\n});\n"]}