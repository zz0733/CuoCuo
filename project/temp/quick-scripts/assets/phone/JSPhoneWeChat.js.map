{"version":3,"sources":["JSPhoneWeChat.js"],"names":["className","appUrl","wechat","WxAppIsInstalled","isInstall","cc","sys","os","OS_IOS","jsb","reflection","callStaticMethod","WxLogin","func","_wxLoginFunc","OS_ANDROID","WxShareFriend","info","url","JSON","stringify","WxShareCircle","sharePath","fileData","fileUtils","getDataFromFile","newPath","getWritablePath","writeDataToFile","WxShareFriendScreen","fun","utils","screenShoot","filename","WxPay","WxReLogin","openid","token","console","log","state","WxReShareResult","result","event","dispatch","WxRePayResult","from","module","exports"],"mappings":";;;;;;AAAA,IAAMA,YAAY,qCAAlB;AACA,IAAMC,SAAS,8BAAf;;AAEA,IAAIC,SAAS;AACT;AACAC,sBAAmB,4BAAU;AACzB,YAAIC,YAAY,IAAhB;AACA,YAAGC,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAxB,EACIJ,YAAYK,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,kBAAjD,CAAZ;AACJ,eAAOP,SAAP;AACH,KAPQ;AAQT;AACAQ,aAAU,iBAASC,IAAT,EAAc;AACpB,aAAKC,YAAL,GAAoBD,IAApB;AACA,YAAGR,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOS,UAAxB,EACIN,IAAIC,UAAJ,CAAeC,gBAAf,CAAgCX,SAAhC,EAA2C,SAA3C,EAAsD,KAAtD,EADJ,KAEK,IAAGK,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAxB,EACDC,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,SAAjD;AACP,KAfQ;AAgBT;AACAK,mBAAgB,uBAASC,IAAT,EAAc;AAC1B;;;;;;;AAOAA,aAAKC,GAAL,GAAWD,KAAKC,GAAL,GAAWD,KAAKC,GAAhB,GAAsBjB,MAAjC;AACA,YAAGI,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOS,UAAxB,EACIN,IAAIC,UAAJ,CAAeC,gBAAf,CAAgCX,SAAhC,EAA2C,eAA3C,EAA4D,uBAA5D,EAAqFmB,KAAKC,SAAL,CAAeH,IAAf,CAArF,EADJ,KAEK,IAAIZ,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAzB,EACDC,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,gBAAjD,EAAmEQ,KAAKC,SAAL,CAAeH,IAAf,CAAnE;AACP,KA9BQ;AA+BT;AACAI,mBAAgB,yBAAU;AACtB,YAAIC,YAAY,2DAAhB;AACA,YAAIC,WAAWd,IAAIe,SAAJ,CAAcC,eAAd,CAA8BH,SAA9B,CAAf;AACA,YAAII,UAAYjB,IAAIe,SAAJ,CAAcG,eAAd,KAAkC,qBAAlD;AACAlB,YAAIe,SAAJ,CAAcI,eAAd,CAA8BL,QAA9B,EAAwCG,OAAxC;;AAEA,YAAGrB,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOS,UAAxB,EACIN,IAAIC,UAAJ,CAAeC,gBAAf,CAAgCX,SAAhC,EAA2C,eAA3C,EAA4D,uBAA5D,EAAqF0B,OAArF,EADJ,KAEK,IAAIrB,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAzB,EACDC,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,gBAAjD,EAAmEe,OAAnE;AACP,KA1CQ;AA2CT;AACAG,yBAAsB,+BAAU;AAC5BC,YAAIC,KAAJ,CAAUC,WAAV,CAAsB,UAASC,QAAT,EAAkB;AACpC,gBAAG5B,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOS,UAAxB,EACIN,IAAIC,UAAJ,CAAeC,gBAAf,CAAgCX,SAAhC,EAA2C,qBAA3C,EAAkE,uBAAlE,EAA2FiC,QAA3F,EADJ,KAEK,IAAI5B,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAzB,EACDC,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,sBAAjD,EAAyEsB,QAAzE;AACP,SALD;AAMH,KAnDQ;AAoDT;AACAC,WAAQ,eAASjB,IAAT,EAAc;AAClB,YAAGZ,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOS,UAAxB,EACIN,IAAIC,UAAJ,CAAeC,gBAAf,CAAgCX,SAAhC,EAA2C,OAA3C,EAAoD,uBAApD,EAA6EmB,KAAKC,SAAL,CAAeH,IAAf,CAA7E,EADJ,KAEK,IAAIZ,GAAGC,GAAH,CAAOC,EAAP,KAAcF,GAAGC,GAAH,CAAOE,MAAzB,EACDC,IAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,QAAjD,EAA2DQ,KAAKC,SAAL,CAAeH,IAAf,CAA3D;AACP,KA1DQ;;AA4DT;AACAkB,eAAY,mBAASC,MAAT,EAAiBC,KAAjB,EAAuB;AAC/BC,gBAAQC,GAAR,CAAY,wBAAZ;AACAD,gBAAQC,GAAR,CAAY,aAAaH,MAAzB;AACAE,gBAAQC,GAAR,CAAY,aAAaF,KAAzB;AACA,YAAG,KAAKvB,YAAR,EAAsB;AAClB,gBAAIsB,UAAUA,WAAW,OAAzB,EACI,KAAKtB,YAAL,CAAkB,EAAC0B,OAAO,IAAR,EAAcH,OAAOA,KAArB,EAA4BD,QAAQA,MAApC,EAAlB,EADJ,KAGI,KAAKtB,YAAL,CAAkB,EAAC0B,OAAO,KAAR,EAAlB;AACP;AACJ,KAvEQ;AAwET;AACAC,qBAAkB,yBAASC,MAAT,EAAgB;AAC9BJ,gBAAQC,GAAR,CAAY,8BAAZ;AACAD,gBAAQC,GAAR,CAAY,aAAaG,MAAzB;AACAZ,YAAIa,KAAJ,CAAUC,QAAV,CAAmB,wBAAnB,EAA6CF,WAAW,GAAX,GAAiB,KAAjB,GAAyBA,MAAtE;AACH,KA7EQ;AA8ET;AACAG,mBAAgB,uBAASH,MAAT,EAAgB;AAC5BJ,gBAAQC,GAAR,CAAY,4BAAZ;AACAD,gBAAQC,GAAR,CAAY,aAAaG,MAAzB;AACAZ,YAAIa,KAAJ,CAAUC,QAAV,CAAmB,gBAAnB,EAAqC,EAACE,MAAM,QAAP,EAAiBJ,QAAQA,MAAzB,EAArC;AACH;;AAnFQ,CAAb;;AAuFAK,OAAOC,OAAP,GAAiB9C,MAAjB","file":"JSPhoneWeChat.js","sourceRoot":"../../../../assets/phone","sourcesContent":["const className = 'org/cocos2dx/javascript/AppActivity';\nconst appUrl = 'http://download.game2me.net/';\n\nlet wechat = {\n    //-- 检测微信是否存在\n    WxAppIsInstalled : function(){\n        let isInstall = true;\n        if(cc.sys.os === cc.sys.OS_IOS)\n            isInstall = jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxAppIsInstalled');\n        return isInstall;\n    },\n    //-- 微信登录 性别 1-男, 2-女, 0-未知\n    WxLogin : function(func){\n        this._wxLoginFunc = func;\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'WxLogin', '()V');\n        else if(cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxLogin');\n    },\n    //-- 微信分享给好友\n    WxShareFriend : function(info){\n        /*\n         * 格式要求\n         * let info     = {};\n         * info.title   = '好友邀请-房间号: 123456';\n         * info.content = '房间信息'\n         * require('JSPhoneWeChat').WxShareFriend(info);\n         */\n        info.url = info.url ? info.url : appUrl;\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'WxShareFriend', '(Ljava/lang/String;)V', JSON.stringify(info));\n        else if (cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxShareFriend:', JSON.stringify(info));\n    },\n    //-- 微信分享到朋友圈\n    WxShareCircle : function(){\n        let sharePath = 'res/raw-assets/resources/hall/texture/wx_share_circle.jpg';\n        let fileData = jsb.fileUtils.getDataFromFile(sharePath);\n        let newPath   = jsb.fileUtils.getWritablePath() + 'wx_share_circle.jpg';\n        jsb.fileUtils.writeDataToFile(fileData, newPath);\n\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'WxShareCircle', '(Ljava/lang/String;)V', newPath);\n        else if (cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxShareCircle:', newPath);\n    },\n    //-- 微信分享截屏到好友\n    WxShareFriendScreen : function(){\n        fun.utils.screenShoot(function(filename){\n            if(cc.sys.os === cc.sys.OS_ANDROID)\n                jsb.reflection.callStaticMethod(className, 'WxShareFriendScreen', '(Ljava/lang/String;)V', filename);\n            else if (cc.sys.os === cc.sys.OS_IOS)\n                jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxShareFriendScreen:', filename);\n        });\n    },\n    //-- 微信支付\n    WxPay : function(info){\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'WxPay', '(Ljava/lang/String;)V', JSON.stringify(info));\n        else if (cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneWeChat', 'WxPay:', JSON.stringify(info));\n    },\n\n    //-- 服务器返回 微信登陆 openid 和 token 登录失败返回android-true/false ios-1/0\n    WxReLogin : function(openid, token){\n        console.log('---* js wxReLogin *---');\n        console.log('openid: ' + openid);\n        console.log('token:  ' + token);\n        if(this._wxLoginFunc) {\n            if (openid && openid !== 'false')\n                this._wxLoginFunc({state: true, token: token, openid: openid});\n            else\n                this._wxLoginFunc({state: false});\n        }\n    },\n    //-- 服务器返回 微信分享结果 android-true/false ios-1/0\n    WxReShareResult : function(result){\n        console.log('---* js WxReShareResult *---');\n        console.log('result: ' + result);\n        fun.event.dispatch('PhoneWeChatShareResult', result === '0' ? false : result);\n    },\n    //-- 服务器返回 微信支付结果 android-true/false ios-1/0\n    WxRePayResult : function(result){\n        console.log('---* js WxRePayResult *---');\n        console.log('result: ' + result);\n        fun.event.dispatch('PhonePayResult', {from: 'wechat', result: result});\n    },\n\n};\n\nmodule.exports = wechat;"]}