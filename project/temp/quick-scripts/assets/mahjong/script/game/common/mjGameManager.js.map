{"version":3,"sources":["mjGameManager.js"],"names":["GameDefine","require","ReconnectMgr","mjNetMgr","mjDataMgr","log","cc","GameManager","initGame","playerDeskList","gameUICB","cleanData","leftPai","get","KEYS","CFG","totalPai","initGameCount","initPlayerData","initMessage","initPhoneStatus","addDt","faPaiPer","inFaPai","reconnetCount","setBtnBackVisi","reSetPlayerStatus","pos","ReconnentData","ChuPlayer","deskType","POSIDS","player","playerList","curPlayer","daPaiPlayer","setCurPaiDirection","getDirection","lastChuPaiDir","lastChuPaiID","CurrentChuTile","setGameStatus","ChuStatus","reSetDapaiData","getInstance","refreRoomCount","roomInfo","ROOMINFO","setGameCount","gameCountStr","onDestroy","cleanMessage","onNetClose","onNetOpen","reConnectInGameUI","needNetWork","getIns","addGameNet","GAME","rmNet","initRoundData","faPaiAnimEndList","f","reCheckBuHua","stop","isRoundIsOver","undefined","totalReduce","isShengPai","refreResidue","isPlaying","ShowHuaList","ShowBuHua","bindUserDirection","gameStart","liujupaiCount","liujupai","k","getComponent","hideWaitName","i","initRound","initPlayerStatus","newRound","paiData","isStartAnim","setShouPai","startPaiData","onFaPaiStart","saizi","saiziData","onFaPaiAnimEnd","setCaiShenPai","CaiShenPai","showCaiShenAnim","onKaishiAnimEnd","hidePaiHitzone","startOptData","showEatUI","meIndex","SELFID","mePlayer","isZhuangJia","showChupaiTips","faPaiEnd","turnToNextPlayer","length","excFucn","call","reBuhuaUpdate","huaData","shift","showPaiOnBegin","showData","clearInterval","ShowHuaTag","setInterval","bind","isVoteOut","hdieReduceNode","cleanRoundData","fapaiMo","meDirection","curChuPaiUdid","cleanPlayerPaiData","cleanPaiData","myDirection","DirectType","DIRECTION_TYPE","directionList","push","NAN","XI","BEI","DONG","meDirIndex","findIndex","x","roDirectionNode","DESKPOS_TYPE","playCount","Round","meDeskPos","destPos","dirIndex","direction","setDirection","zhuangIdx","parseInt","PlayerIdx","initDirectionNodeList","DirectionType","nodeList","getCurDirectionN","directionNodeList","sortGroupPai","groupPai","self","sort","a","b","aSort","getSortId","bSort","ShowPaiNotify","data","getPlayerByPaiData","fIndex","item","showPai","Card","showBuHuaAnim","BuPaiNotify","buData","buPai","id","sortId","isBaiBan","isCaiShenPai","isMagic","creatPlayer","playerIndx","playerSys","playerNode","new","init","setPlayerIdx","refreshData","players","PLAYERS","idx","onUserEnterRoom","playerInfo","YL","info","OnLine","setPlayerData","onRingAddNum","Quan","DissolveRoomNotice","showTotalReport","content","fun","event","dispatch","contentStr","okCb","exiteRoom","hideCloseBtn","exitRoomNoticeIdx","exitRoomNoticeUserid","getplayerByUserID","UserId","onDisbandRoomVoteIn","updateVotingData","onDisbandRoomResultIn","Disbanded","removeVotingPop","prepareNoticeMessage","getPlayerData","Status","PLAYER_READY","READY","paiID","isMagicPai","isWL","caishenInfo","isCaiShen","isBaiDa","initReplayPai","initStartPai","totalList","TileCount","meDeskIndex","Array","Tiles","zhuangNotify","meIdx","dirList","tempIdx","faPaiNoAnim","isJustBegin","fapaiCount","isXiaDesk","update","dt","nextFaPai","faPaiWithAnim","faPaiPerCount","lastFaPaiPlayer","fapaiPIndex","playerArray","showPaiHitzone","maxLen","forEach","index","gaiTime","gaiAllPai","setTimeout","uprightPai","playEffect","pai","pop","faPai","reduce","net","close","refrePlayerXdhs","ReportData","xdhsList","utils","xdhs","showChoosePai","showSamePaiTips","showLiuJuAnim","showLiujuEffect","reSetResidue","reSetLeft","weiCount","reSetPengGangPai","gangPai","pengPai","gangList","pengList","resetPengGangPai","reSetDadePai","paiOutList","addPaiOutList","reserFanPai","fanPaiList","fanPai","resetFanPai","addLiujuCount","MoPaiNotice","moPai","Atile","WLMoPaiNotice","isFaPaiEnd","db","getData","RoomId","director","loadScene","caiShengPai","turnToChupai","udid","canQuickly","ChuPai","cSend","hideChupaiTips","benmenFengNotice","ChuPaiNotice","desPosType","XIA","isReplayPai","TURN_STATUS","WAITOPT","setLastPaiResult","chuPai","paiZuHeReminder","optList","getBinaryOpts","Opts","Comb","Data","ChuPaiZuHeReminder","eatTag","eatData","MoPaiZuHeReminder","curOp","Op","eatPaiData","isShowGuo","unshift","showCanEatUI","guoPaiToServer","chiPaiToServer","comb","chiPaiData","getEatPaiId","dataIndex","eatPaiToServer","eatObj","PengPaiAckMessage","Rst","peng","EATPAI_TYPE","PengPai","ChuPaiZuHeNotice","eatType","cleanEatUI","meUserId","UID","isSelf","PuTongHu","ChiPai","chi","d","s","card","sheng","MingGang2","AnGang","MingGang1","gang","lastChuPaiData","ChiPaiAckMessage","MingGang2PaiAckMessage","gangPaiAck","MingGang1PaiAckMessage","AnGangPaiAckMessage","ZiMoHuPaiAckMessage","isPaiEat","setDaPaiResult","NOTURN","TURNTOPLAY","isVisi","QiangGangReminder","ishaveNext","QiangGangNotice","RestoreListenReminder","roundOver","NO_READY","getFanhuDataHy","itemData","fanData","huData","hsList","fsList","lColor","sColor","endTag","hsxq","FSTEXT","fsData","count","HSTEXT","hsData","name","fan","hu","ZhanJiNoticeHy","result","roundData","shouPai","sp","pxdhs","isWin","iszm","ishu","Scores","fanhuData","curIdx","analyzeZhanji","ZhanJiNoticeWl","Players","huList","Type","isdp","isby","islz","hp","HuCard","HandCards","jdhs","HuShu","TaiShu","DiHu","Feng","paiDataObj","pengGangPai","setShowType","PAISHOWTYPE","PENG","singleZhanjiData","reportData","mjPai","endData","playerData","isWiner","meIsWiner","spPaiList","slice","paiIndex","refreshCaiShen","Fan","FanList","gameRoundata","showPaijuEndAnim","TotalZhanJiWl","totalData","maxCount","pData","detail","value","ZiMo","HuPai","LaZi","BaoPai","DianPao","score","Score","TotalZhanJiNotice","TotalZhanJiHy","hyData","TotalInfos","Spend","Left","hasWin","winCount","isBigWiner","setTotalReport","totalZhanJiData","dpIndex","huIndex","zmIndex","ResultAnimList","rmZiMoPai","showDianPaoAnim","showHuPaiAnim","checkResultAnim","showSingleReport","cb","splice","showDpAnim","VotingReminder","playersInfo","votePlayerIdx","votePlayer","roomPlayers","vInfos","isVoted","VoteInfo","EndTime","VotingTime","VotingRstNotice","VotingRst","PlayerRefused","showName","VotingPlayerRstNotice","pIdx","onUserVoted","code","vRst","VotingInformation","OffLineNotice","OnLineNotice","refrePlayerStatus","status","DAPAIING","setPlayerStatus","ChuPaiReminder","ChatToOther","ChatNotice","chatData","cId","split","type","chatTypeList","ChatMessageAck","rst","SendChatData","showTextChat","CHATCOMMONTEXT","CHATTYPE","TEXT","showChat","showEmojiChat","CHATCOMMONEMOJI","EMOJI","setPlayerCOORD","coordData","coord","lng","lat","onBatteryChange","level","setPhoneBattery","onPhoneNetChange","strength","signal","setPhoneNet","gameReplayMgr","need","onReconnectDataWl","wlReconnected","hideReadyNode","onReconnectDataHy","inGmaeSyncData","renectCount","curReportData","getReportData","allzj","fcount","onPaiTimeChange","Time","showShengPaiKuang","showAnimEffect","module","exports"],"mappings":"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","file":"mjGameManager.js","sourceRoot":"../../../../../../../assets/mahjong/script/game/common","sourcesContent":["/******\n *麻将游戏\n * 事件管理\n 数据驱动部分\n 再分发ui渲染\n ******/\nvar GameDefine      = require(\"mjGameDefine\");\n// var NetMessageMgr   = require(\"NetMessageMgr\");\n// var NetProtocolList = require(\"NetProtocolList\");\nvar ReconnectMgr  = require(\"mjReconnectMgr\");\nvar mjNetMgr        = require(\"mjNetMgr\")\nvar mjDataMgr       = require(\"mjDataMgr\");\nvar log             = cc.log;\n\n\nvar GameManager     = {};\n//初始化数据\nGameManager.initGame = function(playerDeskList, gameUICB){\n\tthis.gameUICB    = gameUICB;\n\tthis.cleanData();\n\tthis.leftPai     = mjDataMgr.get(mjDataMgr.KEYS.CFG).totalPai;\n\tthis.initGameCount();\n\tthis.initPlayerData(playerDeskList); \n\tthis.initMessage();\n\tthis.initPhoneStatus();\n\tthis.addDt      = 0;\n\tthis.faPaiPer   = 0.2;\n\tthis.inFaPai    = false;\n\tthis.reconnetCount = 0;\n\tthis.setBtnBackVisi(false);\n}\n\n\nGameManager.reSetPlayerStatus = function(){\n\tvar pos            = this.ReconnentData.ChuPlayer;\n\tvar deskType       =mjDataMgr.get(mjDataMgr.KEYS.POSIDS)[pos];\n\tvar player         = this.playerList[pos];\n\tthis.curPlayer     = player;\n\tthis.daPaiPlayer   = player;\n\tthis.gameUICB.setCurPaiDirection(player.getDirection());\n\tthis.lastChuPaiDir = deskType;\n\tthis.curPlayer     = player;\n\tthis.lastChuPaiID  = this.ReconnentData.CurrentChuTile\n\tplayer.setGameStatus(this.ReconnentData.ChuStatus);\n\t// this.chuPaiCount\n\tplayer.reSetDapaiData(this.ReconnentData.CurrentChuTile);\t\n\n}\n\n\nGameManager.initGameCount = function(){\n\tmjDataMgr.getInstance().refreRoomCount();\n\tvar roomInfo    = mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO);\n\tthis.gameUICB.setGameCount(roomInfo.gameCountStr);\n\t// this.gameUICB.hideRoomOptBtn();\n}\n\nGameManager.onDestroy  = function(){\n\tthis.cleanData();\n\tthis.cleanMessage()\n}\n\n\nGameManager.onNetClose = function(){\n\t\t// this.reconnetCount += 1;\n\t\t// if(this.reconnetCount > 10){\n\t\t// \tNetMessageMgr.showRestartTips();\n\t\t// \treturn;\n\t\t// }\n\t\t// if(this.reconnetCount > 1) {\n\t\t// \tNetMessageMgr.showTips(\"正在与服务器重连中,第 [\"+this.reconnetCount + \"/10] 次, 请等待\", true)\n\t\t// }\n\t\t// NetMessageMgr.connect();\n\t\n}\n\nGameManager.onNetOpen = function(){\n\tthis.reconnetCount = 0;\n\tvar ReconnectMgr = require(\"mjReconnectMgr\");\n\tReconnectMgr.reConnectInGameUI();\n\n}\n\n\nGameManager.initMessage = function(){\t\n\tif(this.needNetWork()){\n\t\t// NetMessageMgr.addCloseCB(this.onNetClose, this);\n\t\t// NetMessageMgr.addOpenCB(this.onNetOpen, this);\n\t}\n\t// var ReconnectMgr    = require(\"mjReconnectMgr\");\n\t// ReconnectMgr.addReconentMessageCB();\n\tmjNetMgr.getIns().addGameNet(mjNetMgr.KEYS.GAME, this);\n}\n\nGameManager.cleanMessage = function(){\n\tmjNetMgr.getIns().rmNet(mjNetMgr.KEYS.GAME);\n\t// NetMessageMgr.rmCloseCB();\n\t// NetMessageMgr.rmOpenCB();\n\t// var ReconnectMgr    = require(\"mjReconnectMgr\");\n\t// ReconnectMgr.rmReconentMessageCB();\n}\n\nGameManager.initPhoneStatus = function(){\n\t// //FromPhone.addStatusListener(\"Battery\", {cb:this.onBatteryChange, env : this});\n\t// //FromPhone.addStatusListener(\"Net\", {cb:this.onPhoneNetChange, env : this});\n}\n\nGameManager.initRoundData = function(){\n\tthis.faPaiAnimEndList = [{f:this.reCheckBuHua, stop : false}];\n\tthis.isRoundIsOver    = false;\n\tthis.daPaiPlayer      = undefined;\n\tthis.inFaPai          = false;\n\tthis.totalReduce      = 0;\n\tthis.isShengPai       = false;\n\tthis.refreResidue(0);\n\tthis.isPlaying        = true;\n\tthis.ShowHuaList      = [];\n\tthis.ShowBuHua        = {};\n\tthis.leftPai          =mjDataMgr.get(mjDataMgr.KEYS.CFG).totalPai;\n\t// this.paiResultList = {};\n \tthis.bindUserDirection();\n\tthis.gameUICB.gameStart();\n\tthis.liujupaiCount =mjDataMgr.get(mjDataMgr.KEYS.CFG).liujupai;\n    this.setBtnBackVisi(true);\n    for(let k in this.playerDeskList){\n    \tthis.playerDeskList[k].getComponent(\"mjPlayerUI\").hideWaitName();\n    }\n    for(let i in this.playerList){\n\t\tvar player    = this.playerList[i];\n\t\tplayer.initRound();\n\t\tplayer.initPlayerStatus();\n\t\t// player.playerNode.active = true;\n\t\t// this.refrePlayerStatus(player, player.playerStatus);\n\t}\n\tthis.initGameCount();\n}\n\n//发牌新一轮\nGameManager.newRound = function(paiData){\n\tthis.isStartAnim = true;\n\tthis.initRoundData();\n\tfor(let i in this.playerList){\n\t\tvar player = this.playerList[i];\n\t\tplayer.setShouPai(this.startPaiData[i]);\n\t\tplayer.onFaPaiStart();\n\t}\n\tthis.gameUICB.newRound({saizi:this.saiziData});\n}\n\nGameManager.onFaPaiAnimEnd   = function(){\n\tthis.gameUICB.setCaiShenPai(this.CaiShenPai);\n\tthis.gameUICB.showCaiShenAnim();\t\n\t// NetMessageMgr.reSendMessage();\n}\n\n\nGameManager.onKaishiAnimEnd = function(){\n\tthis.isStartAnim = false;\n\tthis.gameUICB.hidePaiHitzone();\n\tif(this.startOptData){\n\t\tthis.showEatUI(this.startOptData);\n\t\tthis.startOptData = undefined;\n\t}\n\tvar meIndex = mjDataMgr.get(mjDataMgr.KEYS.SELFID);\n    var mePlayer = this.playerList[meIndex];\n    if(mePlayer.isZhuangJia()){\n    \tthis.gameUICB.showChupaiTips();\n    }\n\tfor(let i in this.playerList){\n\t\tvar player    = this.playerList[i];\n\t\tplayer.faPaiEnd();\n\t}\n    this.turnToNextPlayer(this.curPlayer);\n    this.daPaiPlayer = this.curPlayer;\n    for(let i =0; i<this.faPaiAnimEndList.length; i++){\n    \tvar excFucn = this.faPaiAnimEndList[i].f;\n    \texcFucn.call(this);\n    \tif(this.faPaiAnimEndList[i].stop){\n    \t\tbreak;\n    \t}\n    }\n    this.faPaiAnimEndList = [];\n}\n\n// GameManager.showBuhuaAnim = function(){\n// \tlog(\"---showBuhuaAnim--2--\", this.ShowHuaList.slice());\n\t\n// \tlog(\"---showBuhuaAnim---1-\", this.ShowHuaList.slice());\n// }\n\n\nGameManager.reCheckBuHua = function(){\n\tif(this.ShowHuaList.length > 0){\n\t\tvar reBuhuaUpdate = function(){\n\t\t\tif(this.ShowHuaList.length > 0){\n\t\t\t\tvar huaData = this.ShowHuaList.shift()\n\t\t\t\thuaData.player.showPaiOnBegin(huaData);\n\t\t\t\tthis.refreResidue(huaData.showData.length);\n\t\t\t}else {\n\t\t\t\tclearInterval(this.ShowHuaTag);\n\t\t\t}\n\t\t}\n\t\tthis.ShowHuaTag = setInterval(reBuhuaUpdate.bind(this), 800);\n\t}\n}\n\n\nGameManager.cleanData = function(){\n\tthis.isVoteOut     = false;\n\tthis.isPlaying     = false;\n\tthis.gameUICB.hdieReduceNode();\n\tthis.cleanRoundData();\n}\n\nGameManager.cleanRoundData = function(){\n\tthis.fapaiMo          = undefined;\n\tthis.startPaiData     = undefined;\n\tthis.meDirection      = undefined;\n\tthis.CaiShenPai       = undefined;\n\tthis.curChuPaiUdid    = undefined;\n\tthis.lastChuPaiDir    = undefined;\n}\n\nGameManager.cleanPlayerPaiData = function(){\n\tfor(let k in this.playerList){\n\t\tlet player = this.playerList[k];\n\t\tplayer.cleanPaiData();\n\t}\n\tthis.cleanRoundData();\n}\n\n\n//设置中间的轮盘数据\nGameManager.bindUserDirection = function(){\n\tvar myDirection   = this.meDirection;\n\tvar DirectType    = GameDefine.DIRECTION_TYPE;\n\t//because in main.fire Nan feng point to  the xia desk;\n\tvar directionList = [];\n\tdirectionList.push(DirectType.NAN);\n\tdirectionList.push(DirectType.XI);\n\tdirectionList.push(DirectType.BEI);\n\tdirectionList.push(DirectType.DONG);\n\tvar meDirIndex =directionList.findIndex(function(x){return x==myDirection});\n\t//先隐藏节点\n\tthis.gameUICB.roDirectionNode(meDirIndex * 90);\n\tvar deskType = GameDefine.DESKPOS_TYPE\n\tthis.saiziData           = {};\n\tthis.saiziData.playCount = mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO).Round;\n\tvar meDeskPos = mjDataMgr.get(mjDataMgr.KEYS.SELFID); \n\tfor(let i= 0; i<4; i++) {\n\t\tvar destPos    = (meDeskPos + i) % 4;\n\t\tvar dirIndex   = (meDirIndex + i) % 4;\n\t\tvar direction  = directionList[dirIndex];\n\t\tvar player     = this.playerList[destPos];\n\t\tif(player){\n\t\t\tplayer.setDirection(direction);\n\t\t\tthis.saiziData[direction] = player;\n\t\t}\n\t\t\n\t}\n\tcc.log(this.saiziData, \" saizi data\");\n\tthis.gameUICB.setCurPaiDirection(DirectType.DONG);\n\tthis.zhuangIdx  = parseInt(this.saiziData[DirectType.DONG].PlayerIdx);\n\tthis.curPlayer = this.playerList[this.zhuangIdx];\n\n}\n\n//做事轮盘方向\nGameManager.initDirectionNodeList = function(){\n\tvar DirectionType            = GameDefine.DIRECTION_TYPE;\n\tvar nodeList                 = {};\n\tnodeList[DirectionType.DONG] = this.gameUICB.getCurDirectionN(\"dong\");\n\tnodeList[DirectionType.XI]   = this.gameUICB.getCurDirectionN(\"xi\");\n\tnodeList[DirectionType.NAN]  = this.gameUICB.getCurDirectionN(\"nan\");\n\tnodeList[DirectionType.BEI]  = this.gameUICB.getCurDirectionN(\"bei\");\n\tthis.directionNodeList       = nodeList;\n}\n\n\n//给牌排序\nGameManager.sortGroupPai = function(groupPai){\n\tvar self = this;\n\tgroupPai.sort(function(a, b){\n        var aSort = self.getSortId(a);\n        var bSort = self.getSortId(b);\n        return aSort - bSort;\n    });\n    return groupPai;\n}\n\nGameManager.ShowPaiNotify = function(data){\n\tvar player = this.getPlayerByPaiData(data);\n\tif(this.isStartAnim){\n\t\tvar fIndex = this.ShowHuaList.findIndex(function(item){ return item.player == player})\n\t\tif(fIndex != -1){\n\t\t\tthis.ShowHuaList[fIndex].showData.push(data)\n\t\t}else {\n\t\t\tthis.ShowHuaList.push({player : player, showData: [data] });\n\t\t}\n\t}else {\n\t\tplayer.showPai(data.Card);\n\t\tthis.refreResidue(1);\n\t\tplayer.showBuHuaAnim();\n\t}\n}\n\nGameManager.BuPaiNotify = function(data){\n\tvar player = this.getPlayerByPaiData(data);\n\tif(this.isStartAnim){\n\t\tvar fIndex = this.ShowHuaList.findIndex(function(item){ return item.player == player})\n\t\tthis.ShowHuaList[fIndex].buData = this.ShowHuaList[fIndex].buData || [];\n\t\tthis.ShowHuaList[fIndex].buData.push(data)\n\t\treturn\n\t}\n\tplayer.buPai(data.Card);\n\t\n}\n\n\nGameManager.getSortId = function(id){\n\tvar sortId = mjDataMgr.getInstance().isBaiBan(id) ? this.CaiShenPai[0] : id;\n    sortId = this.isCaiShenPai(id).isMagic ? -1 : sortId;\n    return sortId;\n}\n\nGameManager.creatPlayer = function(playerIndx){\n\tvar playerSys  = require(\"mjPlayer\");\n\tvar deskType   = mjDataMgr.get(mjDataMgr.KEYS.POSIDS)[playerIndx];\n\tvar playerNode = this.playerDeskList[deskType];\n\tvar player     = playerSys.new();\n\tplayer.init(playerNode, deskType, this.gameUICB);\n\tplayer.setPlayerIdx(playerIndx);\n\tplayer.refreshData();\n    player.initPlayerStatus();\n\tthis.playerList[playerIndx] = player;\n}\n\n//设置座位上的玩家数据\nGameManager.initPlayerData = function (playerDeskList) {\n\tthis.playerList = {};\n\tthis.playerDeskList  = playerDeskList;\n\tvar players      = mjDataMgr.get(mjDataMgr.KEYS.PLAYERS);\n\tfor(let idx in players){\n\t\tthis.creatPlayer(idx);\n\t}\n}\n\n\n\n// /* ---------------- Start Net Message --------------------------*/\n//当玩家进入房间\nGameManager.onUserEnterRoom = function(playerInfo, PlayerIdx){\n\tcc.YL.info(\"玩家进入房间onUserEnterRoom\");\n\tplayerInfo.OnLine = true;\n\tmjDataMgr.getInstance().setPlayerData(playerInfo, PlayerIdx);\n\tthis.creatPlayer(PlayerIdx);\n}\n\nGameManager.onRingAddNum = function(data){\n\tmjDataMgr.get(mjDataMgr.KEYS.ROOMINFO).Quan += 1;\n\tthis.initGameCount();\n}\n\n//解散房间\nGameManager.DissolveRoomNotice = function(){\n\tif(mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO).Round > 0){\n\t\tthis.gameUICB.showTotalReport();\n\t\treturn\n\t}\n\tvar content   = \"房间已经被解散\";\n    fun.event.dispatch('MinSingleButtonPop', {contentStr: content, okCb : this.exiteRoom, hideCloseBtn: true});\n}\n\n//退出房间通知\nGameManager.exitRoomNoticeIdx = function (data) {\n\tvar PlayerIdx = data.PlayerIdx;\n\tmjDataMgr.getInstance().setPlayerData(undefined, PlayerIdx);\n\tvar player = this.playerList[PlayerIdx];\n\tplayer.refreshData();\n\tdelete this.playerList[player.PlayerIdx];\n}\n\n//退出房间通知wl\nGameManager.exitRoomNoticeUserid = function (data) {\n\tcc.log(\"-GameManager.exitRoomNoticeUserid ---\", data);\n\tvar player = this.getplayerByUserID(data.UserId);\n\tmjDataMgr.getInstance().setPlayerData(undefined, player.PlayerIdx);\n\tplayer.refreshData();\n\tdelete this.playerList[player.PlayerIdx];\n}\n\nGameManager.onDisbandRoomVoteIn = function (data) {\n\tthis.gameUICB.updateVotingData(data);\n}\n\nGameManager.onDisbandRoomResultIn = function (data) {\n\tif (data.Disbanded) {\n\t\tthis.DissolveRoomNotice();\n\t} \n\tthis.gameUICB.removeVotingPop();\n}\n\n\nGameManager.prepareNoticeMessage = function (data) {\n\tvar player = this.getPlayerByPaiData(data);\n\tmjDataMgr.getInstance().getPlayerData(player.PlayerIdx).Status = GameDefine.PLAYER_READY.READY;\n\tplayer.initPlayerStatus();\n\tfun.event.dispatch(\"selfReady\", {});\n}\n\n\nGameManager.isCaiShenPai = function(paiID){\n\tvar isMagicPai        = (this.CaiShenPai.findIndex(function(id){return id == paiID}) > -1);\n\tvar roomInfo          = mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO);\n\tvar isWL              = false; //(roomInfo.GameType == gameConst.gameType.maJiangWenLing);\n\tvar caishenInfo       = {isMagic : isMagicPai};\n\tcaishenInfo.isCaiShen = isMagicPai && !isWL;\n\tcaishenInfo.isBaiDa   = isMagicPai && isWL;\n\treturn caishenInfo\n}\n\nGameManager.initReplayPai = function(paiData){\n\tthis.startPaiData = paiData;\n}\n\nGameManager.initStartPai = function(paiData){\n\tvar totalList  = paiData.TileCount;\n\tthis.startPaiData = [];\n\tvar meDeskIndex = mjDataMgr.getInstance().get(mjDataMgr.KEYS.SELFID);\n\tfor(let i in this.playerList){\n\t\tthis.startPaiData[i] =  new Array(totalList[i]);\n\t}\n\tthis.startPaiData[meDeskIndex] = paiData.Tiles\n}\n\nGameManager.zhuangNotify = function(data){\n\t// this.isStartFaPai  = true;\n\tthis.zhuangIdx = parseInt(this.getplayerByUserID(data.UserId).PlayerIdx);\n\tvar meIdx      = mjDataMgr.get(mjDataMgr.KEYS.SELFID);\n\t// GameDefine.DIRECTION_TYPE\n\tvar dirList = [51, 52, 53, 54];//dong nan xi bei\n\tfor(let i = 0; i< dirList.length; i++){\n\t\tvar tempIdx  = (i + this.zhuangIdx) % dirList.length;\n\t\tif(tempIdx == meIdx){\n\t\t\tthis.meDirection = dirList[i];\n\t\t\tbreak;\n\t\t}\n\n\t}\n\tvar roomInfo   = mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO);\n\troomInfo.Quan  = data.Quan;\n\troomInfo.Round = data.Round;\n\tthis.initGameCount();\n}\n\n//isJustBegin 是否是刚开始莫玩牌\nGameManager.faPaiNoAnim = function(isJustBegin){\n\tvar fapaiCount   = 0;\n\tfor(let i in this.playerList){\n\t\tvar player    = this.playerList[i];\n\t\tfapaiCount    += this.startPaiData[i].length;\n\t\tplayer.setShouPai(this.startPaiData[i]);\n\t\tplayer.faPaiEnd();\n\t\tif(player.isXiaDesk() && isJustBegin && player.isZhuangJia()){\n\t\t\tthis.gameUICB.showChupaiTips();\n\t\t}\n\t}\n\t// cai shen pai\n\tfapaiCount += 1;\n\tthis.refreResidue(fapaiCount);\n}\n\nGameManager.update = function(dt){\n\tif(!this.inFaPai){return}\n\tthis.addDt += dt;\n\tif(this.addDt > this.faPaiPer){\n\t\tthis.addDt -= this.faPaiPer;\n\t\tthis.nextFaPai();\n\t}\n}\n\n\n//有发牌动画\nGameManager.faPaiWithAnim = function(){\n\tthis.inFaPai         = true;\n\tthis.faPaiPerCount   = 4;\n\tthis.addDt           = 0;\n\tthis.lastFaPaiPlayer = undefined;\n\tthis.fapaiPIndex     = 0;\n\tthis.playerArray     = [];\n\tfor(let k in this.playerList){\n\t\tthis.playerArray.push(this.playerList[k]);\n\t}\n\n\tthis.gameUICB.showPaiHitzone();\n\tvar maxLen = 0;\n\tthis.startPaiData.forEach(function(item, index){\n\t\tif(item.length > maxLen){\n\t\t\tthis.fapaiPIndex = index;\n\t\t\tmaxLen = item.length;\n\t\t}\n\t}.bind(this));\n\tthis.nextFaPai();\n}\n\nGameManager.faPaiEnd = function(){\n\tvar gaiTime = 0.6;\n\tvar self = this;\n\tfor(let i in this.playerList){\n\t\tvar player = this.playerList[i];\n\t\tplayer.gaiAllPai();\n\t}\n\tsetTimeout(function(){\n\t\tfor(let i in self.playerList){\n\t\t\tvar player = self.playerList[i];\n\t\t\tplayer.uprightPai();\n\t\t}\n\t}, gaiTime * 1000)\n\tthis.refreResidue(1);\n\tthis.inFaPai   = false;\n\tsetTimeout(function(){\n\t\tself.onFaPaiAnimEnd();\n\t}, 1000)\n\t\n}\n\nGameManager.nextFaPai = function(){\n\tif(!this.startPaiData){return}\n\tvar playerIndx     = this.playerArray[this.fapaiPIndex].PlayerIdx;\n\tthis.fapaiPIndex   = (this.fapaiPIndex + 1) % this.playerArray.length;\n\tthis.faPaiPerCount = this.startPaiData[playerIndx].length > 4 ? 4 : this.startPaiData[playerIndx].length;\n\tif(this.faPaiPerCount < 1){\n\t\tthis.faPaiEnd();\n\t\treturn\n\t}\n\trequire('Audio').playEffect(\"mahjong\", \"mahjong.mp3\");\n\tvar paiData    = [] //this.startPaiData\n\tfor(let i =0; i<this.faPaiPerCount; i++){\n\t\tvar pai = this.startPaiData[playerIndx].pop();\n\t\tpaiData.push(pai);\n\t}\n\tthis.refreResidue(this.faPaiPerCount);\n\tvar player = this.playerList[playerIndx];\n\tplayer.faPai(paiData, true);\n\tif(this.lastFaPaiPlayer){\n\t\tthis.lastFaPaiPlayer.uprightPai();\n\t}\n\tthis.lastFaPaiPlayer = player;\n}\n\n\nGameManager.refreResidue = function(reduce){\n\tthis.totalReduce += reduce;\n    this.leftPai =mjDataMgr.get(mjDataMgr.KEYS.CFG).totalPai - this.totalReduce;\n    //本地出错了，导致小于0， 重新连接发牌\n    if(this.leftPai < 0){\n    \tfun.net.close();\n    }\n    this.gameUICB.refreResidue(this.leftPai);\n}\n\n//刷新这几局中玩家的相对胡数\nGameManager.refrePlayerXdhs = function(ReportData){\n\tcc.log(ReportData, \"ReportData\");\n\tvar mjDataMgr = require(\"mjDataMgr\");\n\tvar xdhsList = [0, 0, 0, 0];\n\tfun.utils.forEach(ReportData, function(item){\n\t\tfor(let i=0; i<item.length; i++){\n\t\t\txdhsList[i] += item[i].xdhs;\n\t\t}\n\t})\n\tfor(let i in this.playerList){\n\t\tif(mjDataMgr.getInstance().getPlayerData(i)){\n\t\t\tmjDataMgr.getInstance().getPlayerData(i).xdhs = xdhsList[i] || 0; // xdhsList[i] += item[i].xdhs;\n\t\t\tlet player = this.playerList[i];\n\t\t\tplayer.refreshData();\n\t\t}\n\t\t\n\t}\n\n}\n\nGameManager.showChoosePai = function(paiID){\n\tfor(let i in this.playerList){\n\t\tlet player = this.playerList[i];\n\t\tplayer.showSamePaiTips(paiID);\n\t}\n}\n\nGameManager.showLiuJuAnim = function(){\n\trequire('Audio').playEffect(\"mahjong\", \"result_null.mp3\");\n\tthis.gameUICB.showLiujuEffect();\n}\n\nGameManager.reSetResidue = function(){\n\tthis.leftPai     = this.ReconnentData.reSetLeft;\n\tthis.totalReduce =mjDataMgr.get(mjDataMgr.KEYS.CFG).totalPai - this.leftPai;\n\tthis.liujupaiCount = this.ReconnentData.weiCount;\n\tthis.gameUICB.refreResidue(this.leftPai);\n}\n\nGameManager.reSetPengGangPai = function(){\n\tvar gangPai = this.ReconnentData.gangPai;\n\tvar pengPai = this.ReconnentData.pengPai;\n\tfor(let i in this.playerList){\n\t\tvar player   = this.playerList[i];\n\t\tvar gangList = this.ReconnentData.gangPai[i];\n\t\tvar pengList = this.ReconnentData.pengPai[i];\n\t\tplayer.resetPengGangPai(gangList, pengList);\n\t}\n}\n\nGameManager.reSetDadePai = function(){\n\tvar paiOutList  = this.ReconnentData.paiOutList;\n\tfor(let i in this.playerList){\n\t\tvar player = this.playerList[i];\n\t\tplayer.addPaiOutList(paiOutList[i]); \n\t}\n}\n\nGameManager.reserFanPai = function(){\n\tvar fanPaiList  = this.ReconnentData.fanPai || [];\n\tfor(let i in this.playerList){\n\t\tvar player = this.playerList[i];\n\t\tplayer.resetFanPai(fanPaiList[i]); \n\t}\n}\n\n\nGameManager.addLiujuCount = function(){\n\tthis.liujupaiCount += 1;\n}\n\n\n//摸牌\nGameManager.MoPaiNotice = function(data){\n\tthis.refreResidue(1);\n\tvar destPos = data.PlayerIdx;\n\t//netID 102 没有推送PlayerIdx数据过来 102是自己摸牌\n\tif(destPos === undefined){\n\t\tdestPos = mjDataMgr.get(mjDataMgr.KEYS.SELFID);\n\t}\n\tthis.turnToNextPlayer(this.playerList[destPos])\n\tthis.curPlayer.moPai(data.Atile);\n}\n\n//wenling 摸牌\nGameManager.WLMoPaiNotice = function(data){\n\tvar player = this.getplayerByUserID(data.UserId);\n\tif(this.isFaPaiEnd(data, player)){\n\t\treturn\n\t}\n\tthis.refreResidue(1);\n\tthis.turnToNextPlayer(player)\n\tplayer.moPai(data.Card);\n}\n\t\nGameManager.isFaPaiEnd = function(data, player){\n\tif(!this.fapaiMo){\n\t\tthis.fapaiMo = true;\n\t\tthis.startPaiData[player.PlayerIdx].push(data.Card);\n\t\treturn true\n\t}\n\treturn false;\n}\n\n\n//离开房间\nGameManager.exiteRoom = function(){\n\tfun.db.getData('UserInfo').RoomId = 0;\n\tcc.director.loadScene(\"hall\");\n}\n\n//定财神通知\nGameManager.caiShengPai = function(data){\n\tthis.CaiShenPai = data //data.Atile || data.Card;\n}\n\n//玩家出牌\nGameManager.turnToChupai = function(pai){\n\tthis.showChoosePai(-999);\n\tvar content        = {};\n\tcontent.Atile      = pai.id;\n\tthis.curChuPaiUdid = pai.udid;\n\tif(mjDataMgr.getInstance().canQuickly(pai.id)){\n\t\tthis.ChuPai(this.curPlayer, {Atile:pai.id, PlayerIdx:this.curPlayer.PlayerIdx});\n\t}\n\tmjNetMgr.cSend(\"chuPai\", content);\n\tthis.gameUICB.hideChupaiTips();\n}\n\n//本门风提示\nGameManager.benmenFengNotice = function(data) {\n\tthis.meDirection = data.Atile\n\tthis.newRound();\n}\n\n//出牌提示\nGameManager.ChuPaiNotice = function(data){\n\tvar player   = this.getPlayerByPaiData(data); //this.playerList[data.PlayerIdx];\n\tvar deskType = player.desPosType;\n\tif(deskType  == GameDefine.DESKPOS_TYPE.XIA && !require(\"mjReplayMgr\").isReplayPai()){return}\n\tthis.ChuPai(player, data)\n\t\n}\n\nGameManager.ChuPai = function(player, data){\n\tthis.lastChuPaiDir = player.deskType;\n\tthis.lastChuPaiID  = data.Atile;\n\tplayer.setGameStatus(GameDefine.TURN_STATUS.WAITOPT);\n\tthis.setLastPaiResult(false);\n\tthis.daPaiPlayer = player;\n\tplayer.chuPai(data.Atile, this.curChuPaiUdid);\n}\n\n\nGameManager.getPlayerByPaiData = function(data){\n\tif(data.UserId !== undefined){\n\t\treturn this.getplayerByUserID(data.UserId);\n\t}\n\tif(data.PlayerIdx !== undefined){\n\t\treturn this.playerList[data.PlayerIdx];\n\t}\n}\n\n\nGameManager.paiZuHeReminder = function(data){\n\tvar optList = fun.utils.getBinaryOpts(data.Opts);\n    for(let i=0; i<optList.length; i++){\n        optList[i].Comb  = data.Data;\n        optList[i].Atile = data.Atile;\n    }\n    return optList;\n}\n\n\n //{14 15 [[13 15] [15 16]]}\n//别的玩家出牌后，你可以对此牌进行的操作\nGameManager.ChuPaiZuHeReminder = function(data){\n\tthis.eatTag     = \"chuPai\";\n\tvar eatData     = this.paiZuHeReminder(data);\n\tthis.showEatUI(eatData);\n}\n\nGameManager.MoPaiZuHeReminder = function(data) {\n\tthis.eatTag = \"moPai\"\n\tvar eatData = fun.utils.getBinaryOpts(data.Opts);\n    for(let i=0; i<eatData.length; i++){\n        eatData[i].Comb  = data.Data;\n        eatData[i].Atile = data.Atile;\n        var curOp = eatData[i].Op;\n        if(data.Data && data.Data[curOp]){\n            eatData[i].Atile = data.Data[curOp][0];\n        }\n    }\n\tthis.showEatUI(eatData);\n}\n\nGameManager.showEatUI  = function(data){\n\tif(this.isStartAnim){\n\t\tthis.startOptData = data\n\t\treturn;\n\t}\n\tthis.eatPaiData = data[0];\n\tif(this.isShowGuo()){\n\t\t//add guo\n\t\tdata.unshift({Op : 8})\n\t}\n\tthis.gameUICB.showCanEatUI(data);\n}\n\n\n//过牌\nGameManager.guoPaiToServer = function(){\n\tvar content = {\n\t\tAtile : this.eatPaiData.Atile,\n\t};\n\tmjNetMgr.cSend(\"passOpt\", content, this.eatTag);\n}\n\n//吃牌\nGameManager.chiPaiToServer = function(eatData, comb){\n\tvar content = {\n\t\tAtile : eatData.Atile,\n\t\tData  : comb,\n\t};\n\tthis.chiPaiData = content;\n\tmjNetMgr.cSend(\"chiPaiOpt\", content);\n}\n\nGameManager.getEatPaiId = function(dataIndex){\n\tvar paiID;\n\tif(this.eatTag === \"moPai\"){\n\t\tpaiID = this.eatPaiData.Data ? this.eatPaiData.Data[dataIndex] : undefined;\n\t\tpaiID = paiID !== undefined ? paiID[0] : this.eatPaiData.Atile;\n\t}else {\n\t\tpaiID = this.eatPaiData.Atile;\n\t}\n\treturn paiID\n}\n\n\n //碰杠胡牌\nGameManager.eatPaiToServer = function(eatObj, eatData){\n\tthis.eatPaiData.Atile = eatData.Atile;\n\tvar content = {\n\t\tAtile : eatData.Atile,\n\t}\n\tmjNetMgr.cSend(\"optPai\", content, eatObj);\n\t\n}\n// 碰牌 AcK\nGameManager.PengPaiAckMessage = function(data){\n\tif(data.Rst == true){\n\t\tvar player = this.playerList[mjDataMgr.get(mjDataMgr.KEYS.SELFID)]\n\t\tplayer.peng(this.eatPaiData.Atile, true);\n\t\t// this.paiResultList[this.chuPaiCount] = GameDefine.CHUPAIRESULT.EATED;\n\t\tthis.turnToNextPlayer(player);\n\t\tthis.setLastPaiResult(GameDefine.EATPAI_TYPE.PengPai);\n\t}\n}\n\n\n//某人碰||杠||胡||吃牌了\nGameManager.ChuPaiZuHeNotice = function(data){\n\tvar eatType = fun.utils.getBinaryOpts(data.Opts)[0].Op //this.getEatTypeList(data.Opts)[0];\n\tvar player   = this.getPlayerByPaiData(data); //this.playerList[data.PlayerIdx];\n\tthis.gameUICB.cleanEatUI();\n\tvar meUserId = mjDataMgr.get(mjDataMgr.KEYS.UID);\n\tvar isSelf   = (data.UserId && meUserId == data.UserId);\n\tif(!(eatType == GameDefine.EATPAI_TYPE.PuTongHu)){\n\t\t// this.paiResultList[this.chuPaiCount] = GameDefine.CHUPAIRESULT.EATED;\n\t\tthis.turnToNextPlayer(player);\n\t}\n\t//碰牌\n\tif(eatType === GameDefine.EATPAI_TYPE.PengPai){\n\t\tplayer.peng(data.Atile, isSelf);\n\t}\n\tif(eatType === GameDefine.EATPAI_TYPE.ChiPai){\n\t\tplayer.chi({d:data.Data, s:isSelf, card:data.Atile, sheng: this.isShengPai});\n\t}\n\t//min gang\n\tif(eatType === GameDefine.EATPAI_TYPE.MingGang2 || \n\t\teatType === GameDefine.EATPAI_TYPE.AnGang ||\n\t\teatType === GameDefine.EATPAI_TYPE.MingGang1){\n\t\tplayer.gang(data.Atile, isSelf, eatType);\n\t}\n\tthis.setLastPaiResult(eatType);\n\tthis.lastChuPaiData = data;\n}\n\n//吃牌的 ACK\nGameManager.ChiPaiAckMessage = function(data){\n\tif(data.Rst == true){\n\t\tvar player = this.playerList[mjDataMgr.get(mjDataMgr.KEYS.SELFID)]\n\t\tthis.chiPaiData.Data.push(this.chiPaiData.Atile);\n\t\tplayer.chi({d:this.chiPaiData.Data, s:true, card:this.chiPaiData.Atile, sheng: this.isShengPai});\n\t\tthis.turnToNextPlayer(player);\n\t}\n}\n\n//明杠牌 ACK\nGameManager.MingGang2PaiAckMessage = function(data){\n\tif(data.Rst == true){\n\t\tthis.gangPaiAck(GameDefine.EATPAI_TYPE.MingGang2);\n\t}\n}\n\n//明杠牌 ACK\nGameManager.MingGang1PaiAckMessage = function(data){\n\tif(data.Rst == true){\n\t\tthis.gangPaiAck(GameDefine.EATPAI_TYPE.MingGang1);\n\t}\n}\n\nGameManager.AnGangPaiAckMessage = function(data){\n\tif(data.Rst == true){\n\t\tthis.gangPaiAck(GameDefine.EATPAI_TYPE.AnGang);\n\t}\n}\n\nGameManager.gangPaiAck = function(eatType){\n\tvar player = this.playerList[ mjDataMgr.get(mjDataMgr.KEYS.SELFID) ]\n\tplayer.gang(this.eatPaiData.Atile, true, eatType);\n\t// this.paiResultList[this.chuPaiCount] = GameDefine.CHUPAIRESULT.EATED;\n\tthis.turnToNextPlayer(player);\n\tthis.setLastPaiResult(eatType);\n}\n\nGameManager.ZiMoHuPaiAckMessage = function(data){\n\tif(data.Rst){\n\n\t}\n}\n\n\nGameManager.setLastPaiResult = function(eatType){\n\tvar isPaiEat = (eatType == GameDefine.EATPAI_TYPE.PengPai || \n\t\t\teatType == GameDefine.EATPAI_TYPE.ChiPai || eatType == GameDefine.EATPAI_TYPE.MingGang2 )\n\tif(this.daPaiPlayer){\n\t\tthis.daPaiPlayer.setDaPaiResult(isPaiEat);\n\t\tthis.daPaiPlayer = undefined;\n\t}\n}\n\n\nGameManager.turnToNextPlayer = function(player){\n\tif(this.curPlayer){\n\t\tthis.curPlayer.setGameStatus(GameDefine.TURN_STATUS.NOTURN);\n\t\t// this.curPlayer.setDaPaiResult(isPaiEat);\n\t}\n\tthis.curPlayer = player;\n\tthis.curPlayer.setGameStatus(GameDefine.TURN_STATUS.TURNTOPLAY);\n\tthis.gameUICB.setCurPaiDirection(player.getDirection());\n}\n\nGameManager.setBtnBackVisi = function(isVisi){\n\t// this.gameUICB.setBtnBackVisi(isVisi);\n}\n\n//抢杠提示\nGameManager.QiangGangReminder = function(data){\n\tdata.Opts       = 128; //2^7 就是128， index是7\n\tthis.eatPaiData = data;\n\tthis.eatTag     = \"QiangGang\";\n\tvar eatData     = this.paiZuHeReminder(data);\n\tthis.showEatUI(eatData);\n}\nGameManager.isShowGuo = function(){\n\tvar ishaveNext  = this.leftPai > this.liujupaiCount;\n\treturn ishaveNext;\n}\n\nGameManager.QiangGangNotice = function(data){\n\tdata.Opts = 1;\n\tthis.ChuPaiZuHeNotice(data);\n}\n\nGameManager.RestoreListenReminder = function (data) {\n\tthis.gameUICB.cleanEatUI();\n}\n\nGameManager.roundOver = function(){\n\tfor(let k in this.playerList){\n\t\tvar player = this.playerList[k];\n\t\tmjDataMgr.getInstance().getPlayerData(player.PlayerIdx).Status = GameDefine.PLAYER_READY.NO_READY;\n\t\tplayer.initPlayerStatus();\n\t\t// player.setPlayerStatus(GameDefine.PLAYER_READY.NO_READY)\n\t}\n}\n\nGameManager.getFanhuDataHy = function(itemData){\n\tvar fanData   = \"\";\n\tvar huData    = \"\";\n\tvar hsList    = [];\n\tvar fsList    = [];\n\t//2018/3/5 美术修改，个人觉得比以前丑，可能还要修改，先保留之前的吧\n\t// var lColor    = itemData.isWin ? \"<color=#792f19>\" : \"<color=#454964>\";\n\t// var sColor    = itemData.isWin ? \"<color=#372b2b>\" : \"<color=#2e2121>\";\n\tvar lColor    = \"<color=#552e21>\";\n\tvar sColor    = \"<color=#552e21>\";\n\tvar endTag    = \"</c>\"\n\titemData.hsxq = itemData.hsxq || {};\n    for(let k in itemData.hsxq){\n            if(GameDefine.FSTEXT[k]){\n                var fsData = GameDefine.FSTEXT[k];\n                fsData.count = itemData.hsxq[k];\n                fsList.push(fsData)\n            }\n            if(GameDefine.HSTEXT[k]){\n                var hsData = GameDefine.HSTEXT[k];\n                hsData.count = itemData.hsxq[k];\n                hsList.push(hsData)\n            }\n    }\n    fsList.sort(function(a, b){\n            return b.sort - a.sort;\n    })\n    hsList.sort(function(a, b){\n         return b.sort - a.sort;\n    })\n    for(let i=0; i< fsList.length; i++){\n        fanData += lColor + fsList[i].name + endTag + sColor+ \"+\" + fsList[i].count + endTag + \" \"\n    }\n    for(let i=0; i< hsList.length; i++){\n       huData += lColor + hsList[i].name + endTag + sColor + \"+\" + hsList[i].count + endTag +\" \" \n    }\n    huData = huData.length < 1 ? \"0\" : huData;\n    if(fanData.length > 0){\n        fanData = lColor +\"番数: \" +endTag + fanData;\n        huData  = lColor +\"胡数: \" +endTag + huData;\n    }else {\n        fanData = lColor +\"胡数: \" +endTag + huData;\n        huData  = \"\";\n    }\n    return {fan : fanData, hu: huData};\n}\n\n//huang yan majiang\nGameManager.ZhanJiNoticeHy = function(data){\n\tvar result           = data.info || [];\n\tvar roundData        = {};\n\t\n\tfor(let i in this.playerList){\n\t\tlet itemData     = result[i] || {};\n\t\titemData.shouPai = itemData.sp;\n\t\titemData.xdhs    = itemData.xdhs || 0;\n\t\titemData.pxdhs   = itemData.pxdhs || {};\n\t\titemData.isWin   = (itemData.iszm || itemData.ishu);\n\t\titemData.Scores  = [];\n\t\tvar fanhuData    = this.getFanhuDataHy(itemData)\n\t\titemData.fanData = fanhuData.fan;\n        itemData.huData  = fanhuData.hu;\n\t\tvar player = this.playerList[i];\n\t\t//dong nan xi bei;\n\t\tfor(let k=0; k<4; k++){\n\t\t\tvar curIdx         = (k+this.zhuangIdx) % 4;\n\t\t\tif(curIdx != player.PlayerIdx){\n\t\t\t\titemData.Scores[k] = itemData.pxdhs[curIdx] || 0;\n\t\t\t}else {\n\t\t\t\titemData.Scores[k] = itemData.xdhs;\n\t\t\t}\n\t\t}\n\t\troundData[i]     = itemData;\n\t\t\n\t}\n\tthis.analyzeZhanji(roundData);\n}\n\n//wen ling majiang\nGameManager.ZhanJiNoticeWl = function(data){\n    var roundData      = {};\n    for(let UserId in data.Players){\n\t\tlet PlayerIdx = this.getplayerByUserID(UserId).PlayerIdx;\n\t\tvar itemData  = data.Players[UserId];\n\t\tvar huList    = fun.utils.getBinaryOpts(itemData.Type);\n\t\thuList.forEach(function(item){\n\t\t\titemData.ishu = (item.Op == 0) ? true : itemData.ishu;\n\t\t\titemData.isdp = (item.Op == 1) ? true : itemData.isdp;\n\t\t\titemData.iszm = (item.Op == 2) ? true : itemData.iszm;\n\t\t\titemData.isby = (item.Op == 3) ? true : itemData.isby;\n\t\t\titemData.islz = (item.Op == 4) ? true : itemData.islz;\n\t\t})\n\t\titemData.hp          = itemData.HuCard;\n\t\titemData.shouPai     = itemData.HandCards;\n\t\titemData.jdhs        = itemData.HuShu\n\t\titemData.isWin   = (itemData.iszm || itemData.ishu);\n\t\t//2018/3/5 美术修改，个人觉得比以前丑，可能还要修改，先保留之前的吧\n\t\t// var lColor           = itemData.isWin ? \"<color=#792f19>\" : \"<color=#454964>\";\n\t\t// var sColor           = itemData.isWin ? \"<color=#372b2b>\" : \"<color=#2e2121>\";\n\t\tvar sColor = \"<color=#552e21>\";\n\t\tvar lColor = '<color=#552e21>';\n\t\tvar endTag           = \"</c>\"\n\t\titemData.fanData     = lColor + \"台数: \"+ endTag + sColor + itemData.TaiShu + endTag;\n\t\titemData.huData      = lColor + \"胡数: \"+ endTag + sColor + itemData.DiHu + endTag; \n\t\titemData.xdhs        = itemData.Scores[itemData.Feng];\n\t\t\n\t\troundData[PlayerIdx] = itemData\n    }\n    //2018/2/26 陈锋修改结算界面将碰吃牌不横着\n    \tfor(let k in this.playerList){\n    \t\tvar peng      = this.playerList[k].paiDataObj.pengGangPai.peng;\n    \t\tcc.log(\" 陈锋修改结算界面将碰吃牌不横着\", peng);\n\t\t\tfor(let i=0; i<peng.length; i++){\n\t\t\t\tfor(let k =0; k<peng[i].length; k++){\n\t\t\t\t\tlet pai = peng[i][k];\n\t\t\t\t\tpai.setShowType(GameDefine.PAISHOWTYPE.PENG);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t    }\n    \n\n    this.analyzeZhanji(roundData);\n}\n\n\nGameManager.analyzeZhanji = function(roundData){\n\tthis.gameUICB.cleanEatUI();\n\tvar singleZhanjiData = [];\n\tvar reportData       = [];\n\tvar mjPai  = require(\"mjPai\");\n\tvar meIdx  = mjDataMgr.get(mjDataMgr.KEYS.SELFID);\n\t//从东南西北开始显示\n\tfor(let i = 0; i<4; i++){\n\t\tvar curIdx         = (i+this.zhuangIdx) % 4;\n\t\tif(!this.playerList[curIdx]){\n\t\t\tcontinue;\n\t\t}\n\t\tlet endData        = roundData[curIdx];\n\t\t// endData\n\t\tendData.player     = this.playerList[curIdx];\n\t\tendData.isZhuangJia= (curIdx == this.zhuangIdx);\n\t\tendData.playerData = mjDataMgr.getInstance().getPlayerData(curIdx);\n\t\tendData.jdhs       = endData.jdhs || 0;//juedui hu shu\n\t\tendData.xdhs       = endData.xdhs || 0;//xiangdui hushu\n\t\tendData.shouPai.sort();\n\t\tmjDataMgr.getInstance().getPlayerData(curIdx).xdhs += endData.xdhs;\n\t\tendData.player.refreshData();\n\t\tendData.isWiner    = (endData.ishu || endData.iszm);\n\t\tif(endData.isWiner){\n\t\t\tsingleZhanjiData.meIsWiner = (curIdx == meIdx);\n\t\t}\n\t\tlet spPaiList = endData.shouPai.slice();\n        for(let paiIndex =0; paiIndex< spPaiList.length; paiIndex++){\n\t\t\tvar pai       = mjPai.new(spPaiList[paiIndex]);\n        \tpai.refreshCaiShen();\n        \tpai.setShowType(GameDefine.PAISHOWTYPE.PENG);\n        \tendData.shouPai[paiIndex] = pai;\n        }\n       \tif(endData.Fan){\n       \t\tendData.FanList = [];\n       \t\tendData.Fan.forEach(function(paiID){\n       \t\t\tvar pai       = mjPai.new(paiID);\n       \t\t\tpai.refreshCaiShen();\n\t        \tpai.setShowType(GameDefine.PAISHOWTYPE.PENG);\n\t        \tendData.FanList.push(pai);\n       \t\t}.bind(this))\n       \t}\n\t\tsingleZhanjiData.push(endData);\n\t\treportData[curIdx] = endData;\n\t}\n\tthis.gameRoundata     = roundData;\n\tthis.singleZhanjiData = singleZhanjiData;\n\tfun.event.dispatch(\"addReportData\", reportData);\n\tif(this.isStartAnim){\n\t\tthis.faPaiAnimEndList.unshift({f:this.showPaijuEndAnim, stop : true})\n\t}else {\n\t\tthis.showPaijuEndAnim();\n\t\t\n\t}\n}\n\n\nGameManager.TotalZhanJiWl = function(data){\n\tvar totalData     = {};\n\ttotalData.players = {};\n\tvar maxCount = 1;\n\tfor(let UserId in data.Players){\n\t\tlet PlayerIdx = this.getplayerByUserID(UserId).PlayerIdx;\n\t\tvar pData  = data.Players[UserId];\n\t\tvar itemData    = pData;\n\t\titemData.playerData = mjDataMgr.getInstance().getPlayerData(PlayerIdx);\n\t\titemData.detail     = [];\n\t\titemData.detail.push({name : \"自摸\", value : pData.ZiMo});\n\t\titemData.detail.push({name : \"胡牌\", value : pData.HuPai});\n\t\titemData.detail.push({name : \"辣子\", value : pData.LaZi});\n\t\titemData.detail.push({name : \"包圆\", value : pData.BaoPai});\n\t\titemData.detail.push({name : \"点炮\", value : pData.DianPao});\n\t\t// itemData.detail.push({name : \"地胡次数:\", value : data[5]});\n\t\titemData.score    = pData.Score;\n\t\tmaxCount = (itemData.score > maxCount) ? itemData.score : maxCount;\n\t\ttotalData.players[PlayerIdx] = itemData;\n\n\t}\n\ttotalData.maxCount = maxCount;\n\tthis.TotalZhanJiNotice(totalData);\n}\n\nGameManager.TotalZhanJiHy = function(hyData){\n\tvar data = hyData.TotalInfos;\n\tvar totalData = {};\n\ttotalData.players = {};\n\tvar maxCount = 1;\n\tfor(let i in data){\n\t\tvar pData                    = data[i];\n\t\tlet itemData                 = {};\n\t\titemData.playerData          = mjDataMgr.getInstance().getPlayerData(i);\n\t\titemData.detail              = [];\n\t\titemData.detail.push({name   : \"自摸\", value : pData[0]});\n\t\titemData.detail.push({name   : \"胡牌\", value : pData[1]});\n\t\titemData.detail.push({name   : \"辣子\", value : pData[2]});\n\t\titemData.detail.push({name   : \"包圆\", value : pData[3]});\n\t\titemData.detail.push({name   : \"天胡\", value : pData[4]});\n\t\t// itemData.detail.push({name: \"地胡次数:\", value : pData[5]});\n\t\titemData.score               = pData[6];\n\t\titemData.Spend               = pData[7];\n\t\titemData.Left                = pData[8];\n\t\tmaxCount = (itemData.score > maxCount) ? itemData.score : maxCount;\n\t\ttotalData.players[i] = itemData;\n\t}\n\ttotalData.maxCount = maxCount;\n\tthis.TotalZhanJiNotice(totalData);\n}\n\nGameManager.TotalZhanJiNotice = function(data){\n\tfor(let i in data.players){\n\t\tvar itemData        = data.players[i];\n\t\titemData.hasWin     = itemData.score > 0 ;\n\t\titemData.winCount   = itemData.hasWin ?  \"+\" + itemData.score : itemData.score;\n\t\titemData.isBigWiner = (itemData.score == data.maxCount);\n\t}\n\tvar meIdx      = mjDataMgr.get(mjDataMgr.KEYS.SELFID);\n\tcc.log(\"--------- data.players---------\",  data.players, meIdx);\n\tdata.meIsWiner = data.players[meIdx].isBigWiner\n\tthis.gameUICB.setTotalReport(data);\n\tthis.totalZhanJiData = data;\n\t// if(!this.singleZhanjiData){\n\t// \n\t// }\n}\n\nGameManager.showPaijuEndAnim = function(){\n\tvar roundData                   = this.gameRoundata;\n\tthis.isPlaying                  = false;\n\tvar dpIndex   = -1;\n\tvar huIndex   = -1;\n\tvar zmIndex   = -1;\n\tfor(let idx in roundData){\n\t\tlet item = roundData[idx];\n\t\tif(item.isdp){\n\t\t\tdpIndex = idx;\n\t\t}\n\t\tif(item.ishu || item.iszm){\n\t\t\thuIndex = idx;\n\t\t}\n\t\tif(item.iszm){\n\t\t\tzmIndex = idx;\n\t\t}\n\n\t}\n\tthis.ResultAnimList   = [];\n\tif(zmIndex> -1){\n\t\tvar player = this.playerList[zmIndex];\n\t\tplayer.rmZiMoPai();\n\t}\n\tif(dpIndex > -1){\n\t\tthis.ResultAnimList.push( function(){\n\t\t\tthis.showDianPaoAnim(dpIndex);\n\t\t}.bind(this));\n\t}\n\tif(huIndex > -1){\n\t\tthis.ResultAnimList.push( function(){\n\t\t\tthis.showHuPaiAnim(huIndex, roundData[huIndex]);\n\t\t}.bind(this));\n\t}else {\n\t\tthis.ResultAnimList.push(function(){\n\t\t\tthis.showLiuJuAnim();\n\t\t}.bind(this))\n\t}\n\tcc.log(\"---GameManager.showPaijuEndAnim------\")\n\tthis.checkResultAnim();\n}\n\nGameManager.checkResultAnim = function(){\n\tcc.log(\"checkResultAnim 1za  \", this.ResultAnimList);\n\tif(this.ResultAnimList.length === 0){\n\t\tcc.log(\"show showSingleReport\", this.singleZhanjiData);\n\t\tthis.gameUICB.showSingleReport(this.singleZhanjiData);\n\t\tthis.roundOver();\n\t\treturn;\n\t}\n\tvar cb = this.ResultAnimList.splice(0, 1)[0];\n\tsetTimeout(function(){\n\t\tcb();\n\t}, 300)\n\t\n}\n\n\nGameManager.showDianPaoAnim = function(pos){\n\tvar player   = this.playerList[pos];\n\tplayer.showDpAnim();\n\trequire('Audio').playEffect(\"mahjong\", \"fangpao.mp3\");\n}\n\nGameManager.showHuPaiAnim   = function(pos, itemData){\n\tvar player = this.playerList[pos];\n\tplayer.showHuPaiAnim(itemData);\n\trequire('Audio').playEffect(\"mahjong\", \"hupai.mp3\");\n\tsetTimeout(function(){\n\t\trequire('Audio').playEffect(\"mahjong\", \"cpghz.mp3\");\n\t}, 250)\n}\n\n//show votiing window\nGameManager.VotingReminder = function(data){\n\tvar playersInfo   = {};\n\tvar votePlayerIdx = 0;\n\tvar votePlayer    = {};\n\tvar roomPlayers = mjDataMgr.get(mjDataMgr.KEYS.PLAYERS);\n\tfor(let idx in roomPlayers){\n\t\tvar player = roomPlayers[idx];\n\t\t\tvar UserId = player.UserId;\n\t\t\tplayersInfo[UserId]            = (idx == data.PlayerIdx) ? 1 : 0;\n\t\t\tcc.log(data.vInfos);\n\n\t\t\tif(data.vInfos && data.vInfos[idx] && data.vInfos[idx].isVoted){\n\t\t\t\tplayersInfo[UserId]  =  2;\n\t\t\t}\n\t}\n\tdata.VoteInfo = playersInfo;\n\tdata.EndTime   = data.VotingTime;\n\tthis.gameUICB.updateVotingData(data);\n}\n\n\nGameManager.VotingRstNotice = function(data){\n\tthis.gameUICB.removeVotingPop();\n\tif(data.VotingRst){\n\t\tthis.DissolveRoomNotice()\n\t}else {\n\t\tvar player = mjDataMgr.getInstance().getPlayerData(data.PlayerRefused);\n\t\tvar content   = player.showName + \" 拒绝解散房间!\";\n    \tfun.event.dispatch('MinSingleButtonPop', {contentStr: content});\n\t}\n\n}\n\nGameManager.VotingPlayerRstNotice = function (data) {\n\tvar player = this.playerList[data.pIdx];\n\tthis.gameUICB.onUserVoted({UserId : player.UserId, code: (data.vRst ? 2 : 3)});\n}\n\nGameManager.VotingInformation = function(data){\n\tthis.VotingReminder(data)\n}\n\nGameManager.getplayerByUserID = function(UserId){\n\tfor(let k in this.playerList){\n\t\tvar player = this.playerList[k];\n\t\tif(player.UserId == UserId){\n\t\t\treturn player\n\t\t}\n\t}\n}\n\nGameManager.OffLineNotice = function(data){\n\tvar player = this.getplayerByUserID(data.UserId);\n\tmjDataMgr.getInstance().getPlayerData(player.PlayerIdx).OnLine = false;\n\tplayer.initPlayerStatus();\n}\n\nGameManager.OnLineNotice = function(data){\n\tvar player = this.getplayerByUserID(data.UserId);\n\tif(data.Status != undefined){\n\t\tmjDataMgr.getInstance().getPlayerData(player.PlayerIdx).Status = data.Status;\n\t}\n\tmjDataMgr.getInstance().getPlayerData(player.PlayerIdx).OnLine = true;\n\tplayer.initPlayerStatus();\n}\n\n\nGameManager.refrePlayerStatus = function(player, status){\n\tif(status == GameDefine.PLAYER_READY.READY && this.isPlaying){\n\t\tstatus = GameDefine.PLAYER_READY.DAPAIING;\n\t}\n\tplayer.setPlayerStatus(status);\n}\n\n\nGameManager.ChuPaiReminder = function(){\n\t// ChuPaiReminder\n}\n\nGameManager.ChatToOther = function(item){\n\t// var content = {\n\t// \tpIdx : mjDataMgr.get(mjDataMgr.KEYS.SELFID),\n\t// \tcId : item.type + \":::\" + item.id, //::: 是分隔F\n\t// }\n\t// this.SendChatData = content;\n\t// NetMessageMgr.send(NetProtocolList.ChatMessageNum.netID, content);\n\n}\n\nGameManager.ChatNotice = function(data){\n\tvar chatData = data.cId.split(\":::\");\n\tvar type = chatData[0];\n\tvar cb = this.chatTypeList[type];\n\tif(cb){\n\t\tcb.call(this, data.pIdx, chatData[1]);\n\t}\n}\n\nGameManager.ChatMessageAck = function(data){\n\tif(data.rst){\n\t\tthis.ChatNotice(this.SendChatData);\n\t}\n}\n\nGameManager.showTextChat = function(idx, cId){\n\tvar chatData = {};\n\tfun.utils.forEach(GameDefine.CHATCOMMONTEXT, function(item){\n\t\tif(item.id == cId){\n\t\t\tchatData = item;\n\t\t}\n\t})\n\tchatData.type = GameDefine.CHATTYPE.TEXT;\n\tvar player    = this.playerList[idx];\n\tplayer.showChat(chatData);\n}\n\nGameManager.showEmojiChat = function(idx, cId){\n\tvar chatData = {};\n\tfun.utils.forEach(GameDefine.CHATCOMMONEMOJI, function(item){\n\t\tif(item.id == cId){\n\t\t\tchatData = item;\n\t\t}\n\t})\n\tchatData.type = GameDefine.CHATTYPE.EMOJI;\n\tvar player    = this.playerList[idx];\n\tplayer.showChat(chatData);\n}\n\nGameManager.setPlayerCOORD = function(idx, coordData){\n\tvar coord = {}\n\tcoordData = coordData.split(\",,\");\n\tcoord.lng = coordData[0];\n\tcoord.lat = coordData[1];\n\tmjDataMgr.getInstance().setPlayerCOORD(idx, coord);\n}\n\nGameManager.onBatteryChange = function(status, level){\n\tthis.gameUICB.setPhoneBattery(status, level)\n}\n\nGameManager.onPhoneNetChange = function(status, strength, signal){\n\tthis.gameUICB.setPhoneNet(status, strength, signal)\n}\n\n//回放是不需要网络操作\nGameManager.needNetWork = function(){\n\tvar gameReplayMgr = require(\"mjReplayMgr\");\n\tvar need          = true;\n\tneed              = gameReplayMgr.isReplayPai() ? false : need;\n\treturn need;\n}\n\n\nGameManager.onReconnectDataWl = function(data){\n\tvar ReconnectMgr    = require(\"mjReconnectMgr\");\n\tReconnectMgr.wlReconnected(data);\n\tthis.gameUICB.hideReadyNode();\n}\n\n\nGameManager.onReconnectDataHy= function(data){\n\tvar ReconnectMgr    = require(\"mjReconnectMgr\");\n\tReconnectMgr.inGmaeSyncData(data);\n\tthis.gameUICB.hideReadyNode();\n} \n\nGameManager.renectCount = function(data){\n\tvar ReconnectMgr   = require(\"mjReconnectMgr\");\n\tvar mjDataMgr      = require(\"mjDataMgr\");\n\tvar curReportData  = ReconnectMgr.getReportData(data.allzj);\n\tvar roomInfo       = mjDataMgr.get(mjDataMgr.KEYS.ROOMINFO);\n\troomInfo.Quan      = (data.fcount || 1);\n\troomInfo.Round     = curReportData.length;\n\tthis.initGameCount();\n\tfun.event.dispatch(\"resetReportData\", curReportData);\n\tthis.refrePlayerXdhs(curReportData);\n}\n\nGameManager.onPaiTimeChange = function(data){\n\tif(data.Time == 1){\n\t\tthis.gameUICB.showShengPaiKuang();\n\t\tthis.isShengPai = true;\n\t\trequire('Audio').playEffect(\"mahjong\", \"dangerstage.mp3\");\n\t\tthis.gameUICB.showAnimEffect(\"AnimShengpai\");\n\t}\n}\n\n\n// /* ---------------- End Net Message --------------------------*/\n\nmodule.exports = GameManager;"]}