{"version":3,"sources":["whPaiTouch.js"],"names":["WhDefine","require","WhUtils","cc","Class","extends","Component","properties","onLoad","originalPos","node","getPosition","touchOn","onDestroy","touchOff","on","onPaiClick","moveTouchFunc","endCancelTouchFunc","off","setCardNumber","card","cardInfo","cardNumber","xiaCP","checkDoubleClick","nowTime","Date","getTime","_clickTime","DoubleClickTime","parent","getComponent","chuPai","active","event","_isMove","setXianVisible","sys","isNative","setPosition","touch","getDelta","p","getLocation","x","y","getPositionY","PlayCardHeight"],"mappings":"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","file":"whPaiTouch.js","sourceRoot":"../../../../../../../assets/mahjong/script/wahua/prefab","sourcesContent":["const WhDefine = require('whDefine');\nconst WhUtils = require('whUtils');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        \n    },\n\n    onLoad() {\n        this.originalPos = this.node.getPosition();\n        this.touchOn();\n    },\n\n    onDestroy() {\n        this.touchOff();\n    },\n\n    touchOn() {\n        this.node.on('click', this.onPaiClick, this);\n        this.node.on('touchmove', this.moveTouchFunc, this);\n        this.node.on('touchend', this.endCancelTouchFunc, this);\n        this.node.on('touchcancel', this.endCancelTouchFunc, this);\n    },\n\n    touchOff() {\n        this.node.off('click', this.onPaiClick, this);\n        this.node.off('touchmove', this.moveTouchFunc, this);\n        this.node.off('touchend', this.endCancelTouchFunc, this);\n        this.node.off('touchcancel', this.endCancelTouchFunc, this);\n    },\n\n    setCardNumber(card) {\n        this.cardInfo = { cardNumber: card, xiaCP: true };\n    },\n\n    checkDoubleClick() {\n        let nowTime = new Date().getTime();\n        if (this._clickTime) {\n            if (nowTime - this._clickTime < WhDefine.DoubleClickTime * 1000) {\n                this._clickTime = nowTime;\n                return true;\n            } else {\n                this._clickTime = nowTime;\n                return false;\n            }\n        } else {\n            this._clickTime = nowTime;\n            return false;\n        }\n    },\n\n    onPaiClick() {\n        if (this.checkDoubleClick()) {\n            this.node.parent.parent.parent.getComponent('playerUiWahua').chuPai(this.cardInfo, true);\n            this.node.active = false;\n        } \n        // else {\n            // if (this._isMove) return;\n            // this._isMove = false;\n            // this._paiShouldOut = !this._paiShouldOut;\n            // this.node.parent.parent.parent.getComponent('playerUiWahua').xiaPaiAllDown();\n            // this.node.setPositionY(this.originalPos.y + (this._paiShouldOut ? 20 : 0));\n        // }\n    },\n\n    moveTouchFunc(event) {\n        this._isMove = true;\n        this.node.parent.parent.parent.getComponent('playerUiWahua').setXianVisible(true);\n        if (cc.sys.isNative) {\n            this.node.setPosition(event.touch.getDelta());\n        } else {\n            this.node.setPosition(cc.p(event.getLocation().x - 120, event.getLocation().y - 220));\n        }\n    },\n\n    endCancelTouchFunc(event) {\n        this.node.parent.parent.parent.getComponent('playerUiWahua').setXianVisible(false);\n        if (this.node.getPositionY() < WhDefine.PlayCardHeight) {\n            this.node.setPosition(this.originalPos);\n        } else {\n            this.node.parent.parent.parent.getComponent('playerUiWahua').chuPai(this.cardInfo, true);\n            this.node.active = false;\n        }\n    },\n\n});\n"]}