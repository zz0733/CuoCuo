{"version":3,"sources":["DDZ_PokerTouchEvent.js"],"names":["cc","Class","extends","Component","properties","onLoad","node","on","onEndTouch","bind","onCancelTouch","onMoveTouch","onStartTouch","pokerSourceHeight","pokerUpHeight","pokerSpacing","clickFirstPos","posYMin","posYMax","YL","playerOutPokerArr","update","setPosition","parent","getChildByName","getPosition","width","height","scale","event","startTouchPos","getStartLocation","endTouchPos","getLocation","clickPoker","moveTouchPos","y","delatX","x","index_1","caculateIndex","index_2","pokerIndex","getChildByTag","active","i","children","length","childNodeList","DDZAudio","playCommonBGM","info","push","getComponent","pokerID","posX","childrenLen","firstPos","parseInt"],"mappings":"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","file":"DDZ_PokerTouchEvent.js","sourceRoot":"../../../../../../../assets/poker/DDZ/Script/Poker","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.node.on(\"touchend\", this.onEndTouch.bind(this), this.node);\n        this.node.on(\"touchcancel\", this.onCancelTouch.bind(this), this.node);\n        this.node.on(\"touchmove\", this.onMoveTouch.bind(this), this.node);\n        this.node.on(\"touchstart\", this.onStartTouch.bind(this), this.node);\n        this.pokerSourceHeight = 0;\n        this.pokerUpHeight = 20;\n        this.pokerSpacing = 50;\n        this.clickFirstPos = 147.5;\n        this.posYMin = 20;\n        this.posYMax = 230;\n        cc.YL.playerOutPokerArr = [];\n\n    },\n    update: function () {\n        this.node.setPosition(this.node.parent.getChildByName(\"HandPoker\").getPosition());\n        this.node.width = this.node.parent.getChildByName(\"HandPoker\").width + 150;\n        this.node.height = this.node.parent.getChildByName(\"HandPoker\").height + 10;\n        this.node.scale = this.node.parent.getChildByName(\"HandPoker\").scale;\n    },\n    onStartTouch: function (event) {\n        this.startTouchPos = event.getStartLocation();\n    },\n    onCancelTouch: function (event) {\n        this.endTouchPos = event.getLocation();\n        this.clickPoker();\n    },\n    onMoveTouch: function (event) {\n        var moveTouchPos = event.getLocation();\n        if (moveTouchPos.y >= this.posYMin && moveTouchPos.y <= this.posYMax) {\n            // 滑动y轴的有效范围\n            //记录在有效的范围里面，最后的坐标\n            this.moveTouchPos = moveTouchPos;\n            if (this.moveTouchPos.y >= this.posYMin && this.moveTouchPos.y <= this.posYMax) {\n                // 最后结束的时候，y坐标在牌里面，视为成功，否则用滑动中最后一次的坐标\n                var delatX = this.moveTouchPos.x - this.startTouchPos.x;\n                var index_1 = this.caculateIndex(this.startTouchPos.x);\n                var index_2 = this.caculateIndex(this.moveTouchPos.x);\n            }\n            if (delatX == 0) {\n                //单击一次手牌\n                var pokerIndex = this.caculateIndex(this.moveTouchPos.x);\n                this.node.parent.getChildByName(\"HandPoker\").getChildByTag(pokerIndex).getChildByName(\"Cover\").active = true;\n            } else if (delatX > 0) {\n                for (var i = index_1; i <= index_2; i++) {\n                    this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).getChildByName(\"Cover\").active = true;\n                }\n                //从左向右\n            } else if (delatX < 0) {\n                //从右向左\n                for (var i = index_2; i <= index_1; i++) {\n                    if(i>= 0 && i < this.node.parent.getChildByName(\"HandPoker\").children.length){\n                        this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).getChildByName(\"Cover\").active = true;\n                    }\n                }\n            }\n\n        }\n    },\n    onEndTouch: function (event) {\n        this.endTouchPos = event.getLocation();\n        var childNodeList = this.node.parent.getChildByName(\"HandPoker\").children;\n        for(var i = 0; i < childNodeList.length;i++){\n            childNodeList[i].getChildByName(\"Cover\").active = false;\n        }\n        this.clickPoker();\n    },\n    // update (dt) {},\n    clickPoker: function () {\n        cc.YL.DDZAudio.playCommonBGM(2);\n        // 从左到右的起点坐标\n        if (this.endTouchPos.y >= this.posYMin && this.endTouchPos.y <= this.posYMax) {\n            // 最后结束的时候，y坐标在牌里面，视为成功，否则用滑动中最后一次的坐标\n            var delatX = this.endTouchPos.x - this.startTouchPos.x;\n            var index_1 = this.caculateIndex(this.startTouchPos.x);\n            var index_2 = this.caculateIndex(this.endTouchPos.x);\n        } else {\n            var delatX = this.moveTouchPos.x - this.startTouchPos.x;\n            var index_1 = this.caculateIndex(this.startTouchPos.x);\n            var index_2 = this.caculateIndex(this.moveTouchPos.x);\n        }\n        if (delatX == 0) {\n            //单击一次手牌\n            var pokerIndex = this.caculateIndex(this.endTouchPos.x);\n            if (this.node.parent.getChildByName(\"HandPoker\").getChildByTag(pokerIndex).y == this.pokerUpHeight) {\n                this.node.parent.getChildByName(\"HandPoker\").getChildByTag(pokerIndex).y = this.pokerSourceHeight;\n            } else {\n                this.node.parent.getChildByName(\"HandPoker\").getChildByTag(pokerIndex).y = this.pokerUpHeight;\n            }\n        } else if (delatX > 0) {\n            for (var i = index_1; i <= index_2; i++) {\n                if (this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y == this.pokerUpHeight) {\n                    this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y = this.pokerSourceHeight;\n\n                } else {\n                    this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y = this.pokerUpHeight;\n                }\n            }\n            //从左向右\n        } else if (delatX < 0) {\n            //从右向左\n            for (var i = index_2; i <= index_1; i++) {\n                if(i>= 0 && i < this.node.parent.getChildByName(\"HandPoker\").children.length) {\n                    if (this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y == this.pokerUpHeight) {\n                        this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y = this.pokerSourceHeight;\n\n                    } else {\n                        this.node.parent.getChildByName(\"HandPoker\").getChildByTag(i).y = this.pokerUpHeight;\n\n                    }\n                }\n            }\n        }\n        var childNodeList = this.node.parent.getChildByName(\"HandPoker\").children;\n        for(var i = 0; i < childNodeList.length;i++){\n            childNodeList[i].getChildByName(\"Cover\").active = false;\n        }\n        cc.YL.info(\"重制手牌节点的cover为false\");\n        cc.YL.playerOutPokerArr = [];\n        var children = this.node.parent.getChildByName(\"HandPoker\").children;\n        for(var i = 0; i < children.length;i++){\n            if(children[i].y == this.pokerUpHeight){\n                cc.YL.playerOutPokerArr.push(children[i].getComponent(\"DDZ_Poker\").pokerID);\n            }\n        }\n\n    },\n\n    caculateIndex: function (posX) {\n        var childrenLen = this.node.parent.getChildByName(\"HandPoker\").children.length;\n        var firstPos = (20 - childrenLen) * (this.pokerSpacing / 2) + this.clickFirstPos;\n        var pokerIndex = parseInt((posX - firstPos) / this.pokerSpacing);\n        pokerIndex = pokerIndex < this.node.parent.getChildByName(\"HandPoker\").children.length\n            ? pokerIndex\n            : this.node.parent.getChildByName(\"HandPoker\").children.length - 1;\n        return pokerIndex;\n    },\n\n});\n"]}